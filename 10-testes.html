<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-br" xml:lang="pt-br">
<head>
<!-- 2022-10-24 seg 00:27 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Testes</title>
<meta name="author" content="Lucas S. Vieira" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="./main.css" />
<link rel="stylesheet" type="text/css" href="./syntax.css" />
<link id="theme-css" rel="stylesheet" type="text/css" href="./dark-theme.css" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:image" content="../img/cat-i-mage.jpg">
<meta name="theme-color" content="#14171e">
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="index.html"> UP </a>
 |
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">Testes</h1>
<p>
Arquivo: <code>tests.rs</code>.
</p>

<p>
A seguir,  enumero alguns testes  unitários para Majestic  Lisp. Estes
testes tentam seguir as orientações e exemplos da especificação ao máximo.
</p>

<div id="outline-container-org7d339d7" class="outline-2">
<h2 id="org7d339d7"><span class="section-number-2">1.</span> Importações</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #569cd6;">use</span> <span style="color: #569cd6;">regex</span>::<span style="color: #4ec9b0;">Regex</span>;
<span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::{ maj_list, maj_dotted_list };
<span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">printing</span>::{ maj_format, maj_format_raw };
<span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::{ <span style="color: #4ec9b0;">MajState</span>, <span style="color: #4ec9b0;">Maj</span> };
<span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_errorp;
<span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">evaluator</span>::maj_eval;
<span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">reader</span>::<span style="color: #569cd6;">tokenizer</span>::maj_tokenize;
<span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">reader</span>::<span style="color: #569cd6;">parser</span>::maj_parse;
<span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{ maj_car, maj_macroexpand_1 };
</pre>
</div>
</div>
</div>

<div id="outline-container-org6a6402e" class="outline-2">
<h2 id="org6a6402e"><span class="section-number-2">2.</span> Expressões regulares</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>Para testar expressões regulares: <a href="https://rustexp.lpil.uk/">https://rustexp.lpil.uk/</a></li>
<li>Para mais informações e sintaxe: <a href="https://docs.rs/regex/1.4.2/regex/">https://docs.rs/regex/1.4.2/regex/</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">RE_IN_STREAM</span>:  <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>'<span style="color: #569cd6;">static</span> <span style="color: #4ec9b0;">str</span> =
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;stream (in) {0x...}&gt;</span>
    <span style="color: #ce9178;">r"(?u)^#&lt;stream \(in\) \{0x[0-9a-z]*}&gt;$"</span>;
<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">RE_OUT_STREAM</span>: <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>'<span style="color: #569cd6;">static</span> <span style="color: #4ec9b0;">str</span> =
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;stream (out) {0x...}&gt;</span>
    <span style="color: #ce9178;">r"(?u)^#&lt;stream \(out\) \{0x[0-9a-z]*}&gt;$"</span>;
<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">RE_ENVIRONMENT</span>: <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>'<span style="color: #569cd6;">static</span> <span style="color: #4ec9b0;">str</span> =
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;environment {0x...}&gt;</span>
    <span style="color: #ce9178;">r"^(?u)#&lt;environment \{0x[0-9a-z]*\}&gt;$"</span>;
<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">RE_CLOSURE</span>: <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>'<span style="color: #569cd6;">static</span> <span style="color: #4ec9b0;">str</span> =
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (fn (x...)) {0x...}&gt;</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (fn nil) {0x...}&gt;</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (fn (x... . blah)) {0x...}&gt;</span>
    <span style="color: #ce9178;">r"(?u)^#&lt;function \(fn (nil|\((\w+\s*)+(\. \w+)?\))\) \{0x[0-9a-z]*\}&gt;$"</span>;
<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">RE_MACRO</span>: <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>'<span style="color: #569cd6;">static</span> <span style="color: #4ec9b0;">str</span> =
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;macro (mac (x...)) {0x...}&gt;</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;macro (mac nil) {0x...}&gt;</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;macro (mac (x... . blah)) {0x...}&gt;</span>
    <span style="color: #ce9178;">r"(?u)^#&lt;macro \(mac (nil|\((\w+\s*)+(\. \w+)?\))\) \{0x[0-9a-z]*\}&gt;$"</span>;
<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">RE_PRIMITIVE</span>: <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>'<span style="color: #569cd6;">static</span> <span style="color: #4ec9b0;">str</span> =
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (prim fn-name (arity (required X)))&gt;</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (prim fn-name (arity (required 0)))&gt;</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (prim fn-name (arity (variadic X)))&gt;</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (prim fn-name (arity (variadic 0)))&gt;</span>
    <span style="color: #ce9178;">r"(?u)^#&lt;function \(prim ((\w|\W)+) \(arity \((required|variadic) [0-9]*\)\)\)&gt;$"</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd4bf9d3" class="outline-2">
<h2 id="orgd4bf9d3"><span class="section-number-2">3.</span> Macros de teste</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgbf771f8" class="outline-3">
<h3 id="orgbf771f8"><span class="section-number-3">3.1.</span> Comparação direta de formatações</h3>
<div class="outline-text-3" id="text-3-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_format {
    (<span style="color: #9cdcfe;">$state</span>:ident, <span style="color: #9cdcfe;">$x</span>:expr, <span style="color: #9cdcfe;">$y</span>:tt) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">ex</span> = $x;
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fmt</span> = maj_format(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>$state, ex);
        <span style="color: #6a9955;">//</span><span style="color: #6a9955;">println!("fmt = {}", fmt);</span>
        <span style="color: #c586c0;">assert_eq!</span>(fmt, $y);
    };
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_test {
    (<span style="color: #9cdcfe;">$state</span>:ident; $((<span style="color: #9cdcfe;">$x</span>:expr, <span style="color: #9cdcfe;">$y</span>:tt);)+) =&gt; {
        $(test_<span style="color: #c586c0;">format!</span>($state, $x, $y);)*
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgad816bc" class="outline-3">
<h3 id="orgad816bc"><span class="section-number-3">3.2.</span> Comparação de interpretações de AST</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_eval_ast {
    (<span style="color: #9cdcfe;">$state</span>:ident, <span style="color: #9cdcfe;">$x</span>:expr, <span style="color: #9cdcfe;">$env</span>:expr, <span style="color: #9cdcfe;">$y</span>:tt) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">ex</span> = $x;
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">result</span> = maj_eval(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> $state, ex, $env);
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fmt</span> = maj_format(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>$state, result);
        <span style="color: #c586c0;">assert_eq!</span>(fmt, $y);
    };
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_eval_ast_test {
    (<span style="color: #9cdcfe;">$state</span>:ident; $((<span style="color: #9cdcfe;">$x</span>:expr, <span style="color: #9cdcfe;">$env</span>:expr, <span style="color: #9cdcfe;">$y</span>:tt);)+) =&gt; {
        $(<span style="color: #c586c0;">test_eval_ast!</span>($state, $x, $env, $y);)*
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org755860a" class="outline-3">
<h3 id="org755860a"><span class="section-number-3">3.3.</span> Comparação de parsing</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_parser {
    (<span style="color: #9cdcfe;">$state</span>:ident, <span style="color: #9cdcfe;">$expr</span>:tt, <span style="color: #9cdcfe;">$toks</span>:expr, <span style="color: #9cdcfe;">$y</span>:tt) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">tokens</span> = maj_tokenize($expr).unwrap();
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">expected_tokens</span>: <span style="color: #4ec9b0;">Vec</span>&lt;<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #4ec9b0;">str</span>&gt; = $toks;
        <span style="color: #c586c0;">assert_eq!</span>(tokens.len(), expected_tokens.len());
        <span style="color: #569cd6;">for</span> <span style="color: #9cdcfe;">n</span> <span style="color: #569cd6;">in</span> 0..tokens.len() {
            <span style="color: #c586c0;">assert_eq!</span>(tokens[n], expected_tokens[n]);
        }
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">parsed</span> = maj_parse(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> $state, tokens).unwrap();
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fmt</span>    = maj_format_raw(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>$state, parsed, <span style="color: #569cd6;">false</span>);
        <span style="color: #c586c0;">assert_eq!</span>(fmt, $y);
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_parser_test {
    (<span style="color: #9cdcfe;">$state</span>:ident; $((<span style="color: #9cdcfe;">$expr</span>:tt, <span style="color: #9cdcfe;">$toks</span>:expr, <span style="color: #9cdcfe;">$y</span>:tt);)+) =&gt; {
        $(<span style="color: #c586c0;">test_parser!</span>($state, $expr, $toks, $y);)*
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org791ce3c" class="outline-3">
<h3 id="org791ce3c"><span class="section-number-3">3.4.</span> Comparação de falha de parsing</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_parser_fail {
    (<span style="color: #9cdcfe;">$state</span>:ident, <span style="color: #9cdcfe;">$expr</span>:tt) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">tokens</span> = maj_tokenize($expr).unwrap();
        <span style="color: #c586c0;">assert!</span>(maj_parse(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> $state, tokens).is_err());
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_parser_fail_test {
    (<span style="color: #9cdcfe;">$state</span>:ident; $(<span style="color: #9cdcfe;">$expr</span>:tt;)+) =&gt; {
        $(<span style="color: #c586c0;">test_parser_fail!</span>($state, $expr);)*
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org50f91e1" class="outline-3">
<h3 id="org50f91e1"><span class="section-number-3">3.5.</span> Comparação de interpretação</h3>
<div class="outline-text-3" id="text-3-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_eval {
    (<span style="color: #9cdcfe;">$state</span>:ident, <span style="color: #9cdcfe;">$expr</span>:tt, <span style="color: #9cdcfe;">$y</span>:tt) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">tokens</span> = maj_tokenize($expr).unwrap();
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">parsed</span> = maj_parse(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> $state, tokens).unwrap();
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">result</span> = maj_eval(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> $state,
            <span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::do_sym(), parsed),
            <span style="color: #4ec9b0;">Maj</span>::nil());
        <span style="color: #c586c0;">assert!</span>(!maj_errorp(result.clone()).to_bool());
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fmt</span>    = maj_format_raw(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>$state, result, <span style="color: #569cd6;">false</span>);
        <span style="color: #c586c0;">assert_eq!</span>(fmt, $y);
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_eval_test {
    (<span style="color: #9cdcfe;">$state</span>:ident; $((<span style="color: #9cdcfe;">$expr</span>:tt, <span style="color: #9cdcfe;">$y</span>:tt);)+) =&gt; {
        $(<span style="color: #c586c0;">test_eval!</span>($state, $expr, $y);)*
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org31533ec" class="outline-3">
<h3 id="org31533ec"><span class="section-number-3">3.6.</span> Comparação com falha de interpretação</h3>
<div class="outline-text-3" id="text-3-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_eval_fail {
    (<span style="color: #9cdcfe;">$state</span>:ident, <span style="color: #9cdcfe;">$expr</span>:tt) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">tokens</span> = maj_tokenize($expr).unwrap();
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">parsed</span> = maj_parse(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> $state, tokens).unwrap();
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">result</span> = maj_eval(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> $state,
            <span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::do_sym(), parsed),
            <span style="color: #4ec9b0;">Maj</span>::nil());
        <span style="color: #c586c0;">assert!</span>(maj_errorp(result).to_bool());
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_eval_fail_test {
    (<span style="color: #9cdcfe;">$state</span>:ident; $(<span style="color: #9cdcfe;">$expr</span>:tt;)+) =&gt; {
        $(<span style="color: #c586c0;">test_eval_fail!</span>($state, $expr);)*
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org2abe7f4" class="outline-3">
<h3 id="org2abe7f4"><span class="section-number-3">3.7.</span> Comparação com expansão de macro (uma vez)</h3>
<div class="outline-text-3" id="text-3-7">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_macroexpand_1 {
    (<span style="color: #9cdcfe;">$state</span>:ident, <span style="color: #9cdcfe;">$expr</span>:tt, <span style="color: #9cdcfe;">$y</span>:tt) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">tokens</span> = maj_tokenize($expr).unwrap();
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">parsed</span> = maj_parse(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> $state, tokens).unwrap();
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">parsed</span> = maj_car(parsed);
        <span style="color: #569cd6;">let</span> (expanded, worked) =
            maj_macroexpand_1(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> $state, parsed, <span style="color: #4ec9b0;">Maj</span>::nil());
        <span style="color: #569cd6;">if</span> !worked {
            <span style="color: #c586c0;">panic!</span>(<span style="color: #ce9178;">"Failed expansion: {}\nExpected: {}"</span>,
                   maj_format_raw(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>$state, expanded, <span style="color: #569cd6;">false</span>),
                   $y);
        }
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fmt</span> = maj_format_raw(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>$state, expanded, <span style="color: #569cd6;">false</span>);
        <span style="color: #c586c0;">assert_eq!</span>(fmt, $y);
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_macroexpand_1_test {
    (<span style="color: #9cdcfe;">$state</span>:ident; $((<span style="color: #9cdcfe;">$expr</span>:tt, <span style="color: #9cdcfe;">$y</span>:tt);)+) =&gt; {
        $(<span style="color: #c586c0;">test_macroexpand_1!</span>($state, $expr, $y);)*
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org72ec04e" class="outline-3">
<h3 id="org72ec04e"><span class="section-number-3">3.8.</span> Comparação por expressão regular</h3>
<div class="outline-text-3" id="text-3-8">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_regex {
    (<span style="color: #9cdcfe;">$state</span>:ident, <span style="color: #9cdcfe;">$x</span>:expr, <span style="color: #9cdcfe;">$re</span>:tt) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">ex</span>  = $x;
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fmt</span> = maj_format(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>$state, ex);
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">re</span>  = <span style="color: #4ec9b0;">Regex</span>::new($re).unwrap();
        <span style="color: #c586c0;">assert!</span>(re.is_match(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>fmt));
    };
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_fail_regex {
    (<span style="color: #9cdcfe;">$state</span>:ident, <span style="color: #9cdcfe;">$x</span>:expr, <span style="color: #9cdcfe;">$re</span>:tt) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">ex</span>  = $x;
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fmt</span> = maj_format(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>$state, ex);
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">re</span>  = <span style="color: #4ec9b0;">Regex</span>::new($re).unwrap();
        <span style="color: #c586c0;">assert!</span>(!re.is_match(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>fmt));
    };
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_regex_test {
    (<span style="color: #9cdcfe;">$state</span>:ident; $(<span style="color: #9cdcfe;">$pair</span>:expr;)+) =&gt; {
        $(
            <span style="color: #569cd6;">let</span> (x, y) = $pair;
            <span style="color: #c586c0;">test_regex!</span>($state, x, y);
        )*
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org690d704" class="outline-3">
<h3 id="org690d704"><span class="section-number-3">3.9.</span> Comparação com expressão de falha ou não-falha</h3>
<div class="outline-text-3" id="text-3-9">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_fail {
    (<span style="color: #9cdcfe;">$x</span>:expr) =&gt; {
        <span style="color: #c586c0;">assert!</span>(maj_errorp($x).to_bool());
    };
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_dont_fail {
    (<span style="color: #9cdcfe;">$x</span>:expr) =&gt; {
        <span style="color: #c586c0;">assert!</span>(!maj_errorp($x).to_bool());
    };
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_fail_test {
    ($(<span style="color: #9cdcfe;">$x</span>:expr;)+) =&gt; {
        $(<span style="color: #c586c0;">test_fail!</span>($x);)*
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd0d7c6a" class="outline-3">
<h3 id="orgd0d7c6a"><span class="section-number-3">3.10.</span> Arquivos para uso em streams</h3>
<div class="outline-text-3" id="text-3-10">
</div>
<div id="outline-container-org3217485" class="outline-4">
<h4 id="org3217485"><span class="section-number-4">3.10.1.</span> Leitura</h4>
<div class="outline-text-4" id="text-3-10-1">
<div class="org-src-container">
<pre class="src src-fundamental">Hello world
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf4d4e05" class="outline-4">
<h4 id="orgf4d4e05"><span class="section-number-4">3.10.2.</span> Escrita</h4>
<div class="outline-text-4" id="text-3-10-2">
<div class="org-src-container">
<pre class="src src-fundamental">
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org139b84d" class="outline-3">
<h3 id="org139b84d"><span class="section-number-3">3.11.</span> Comparação de resultados de predicados</h3>
<div class="outline-text-3" id="text-3-11">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> test_boolean {
    (<span style="color: #9cdcfe;">$x</span>:expr, <span style="color: #9cdcfe;">$v</span>:literal) =&gt; {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">res</span> = $x;
        <span style="color: #569cd6;">if</span> maj_errorp(res.clone()).to_bool() {
            <span style="color: #c586c0;">panic!</span>(<span style="color: #ce9178;">"Error raised during assertion"</span>);
        }
        <span style="color: #c586c0;">assert_eq!</span>(res.to_bool(), $v);
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">macro_rules!</span> multi_boolean_test {
    ($((<span style="color: #9cdcfe;">$x</span>:expr, <span style="color: #9cdcfe;">$v</span>:literal);)+) =&gt; {
        $(<span style="color: #c586c0;">test_boolean!</span>($x, $v);)*
    }
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0feb590" class="outline-2">
<h2 id="org0feb590"><span class="section-number-2">4.</span> Formatação</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org78e07d4" class="outline-3">
<h3 id="org78e07d4"><span class="section-number-3">4.1.</span> Símbolos</h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_symbol</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"foo"</span>),   <span style="color: #ce9178;">"foo"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"bar"</span>),   <span style="color: #ce9178;">"bar"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"baz"</span>),   <span style="color: #ce9178;">"baz"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"t"</span>),     <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::t(),                         <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"nil"</span>),   <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::nil(),                       <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"&amp;"</span>),     <span style="color: #ce9178;">"&amp;"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"apply"</span>), <span style="color: #ce9178;">"apply"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org141e0c8" class="outline-3">
<h3 id="org141e0c8"><span class="section-number-3">4.2.</span> Cons</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_cons_cell</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">foo</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"foo"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">bar</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"bar"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">baz</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"baz"</span>);

    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::cons(foo.clone(), bar.clone()),
         <span style="color: #ce9178;">"(foo . bar)"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::cons(foo.clone(),
                   <span style="color: #4ec9b0;">Maj</span>::cons(bar.clone(), baz.clone())),
         <span style="color: #ce9178;">"(foo bar . baz)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orge3ce63d" class="outline-3">
<h3 id="orge3ce63d"><span class="section-number-3">4.3.</span> Caracteres</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_character</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'a'</span>),    <span style="color: #ce9178;">"#\\a"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'\x07'</span>), <span style="color: #ce9178;">"#\\&#9223;"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'\t'</span>),   <span style="color: #ce9178;">"#\\tab"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">' '</span>),    <span style="color: #ce9178;">"#\\space"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'\n'</span>),   <span style="color: #ce9178;">"#\\newline"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org6124aa9" class="outline-3">
<h3 id="org6124aa9"><span class="section-number-3">4.4.</span> Streams</h3>
<div class="outline-text-3" id="text-4-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_stream</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::<span style="color: #569cd6;">types</span>::<span style="color: #4ec9b0;">MajStreamDirection</span>;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">stdin</span>  = state.make_stream_stdin();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">stdout</span> = state.make_stream_stdout();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">istream</span> = <span style="color: #4ec9b0;">Maj</span>::stream(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
        <span style="color: #ce9178;">"test-streams-in.txt"</span>,
        <span style="color: #4ec9b0;">MajStreamDirection</span>::<span style="color: #4ec9b0;">In</span>).unwrap();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">ostream</span> = <span style="color: #4ec9b0;">Maj</span>::stream(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
        <span style="color: #ce9178;">"test-streams-out.txt"</span>,
        <span style="color: #4ec9b0;">MajStreamDirection</span>::<span style="color: #4ec9b0;">Out</span>).unwrap();

    <span style="color: #c586c0;">multi_regex_test!</span>(
        state;
        (stdin,           <span style="color: #4ec9b0;">RE_IN_STREAM</span>);
        (stdout,          <span style="color: #4ec9b0;">RE_OUT_STREAM</span>);
        (istream.clone(), <span style="color: #4ec9b0;">RE_IN_STREAM</span>);
        (ostream.clone(), <span style="color: #4ec9b0;">RE_OUT_STREAM</span>);
    );

    state.close_stream(istream);
    state.close_stream(ostream);
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org51199f2" class="outline-3">
<h3 id="org51199f2"><span class="section-number-3">4.5.</span> Números</h3>
<div class="outline-text-3" id="text-4-5">
</div>
<div id="outline-container-org3969f11" class="outline-4">
<h4 id="org3969f11"><span class="section-number-4">4.5.1.</span> Inteiros</h4>
<div class="outline-text-4" id="text-4-5-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_number_integer</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::integer(1), <span style="color: #ce9178;">"1"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::integer(0), <span style="color: #ce9178;">"0"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::integer(-1), <span style="color: #ce9178;">"-1"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::integer(50), <span style="color: #ce9178;">"50"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::integer(295), <span style="color: #ce9178;">"295"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org54cb902" class="outline-4">
<h4 id="org54cb902"><span class="section-number-4">4.5.2.</span> Frações</h4>
<div class="outline-text-4" id="text-4-5-2">
<p>
Frações  não sofrem  simplificação em  sua criação  para que  não haja
complicações em tipos esperados. Então, ignoramos simplificações.
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_number_fraction</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3),    <span style="color: #ce9178;">"2/3"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::fraction(3, 4),    <span style="color: #ce9178;">"3/4"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::fraction(5, 8),    <span style="color: #ce9178;">"5/8"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::fraction(99, 100), <span style="color: #ce9178;">"99/100"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::fraction(5, 2),    <span style="color: #ce9178;">"5/2"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::fraction(-10, 3),  <span style="color: #ce9178;">"-10/3"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(Maj::fraction(2, 4),    "1/2");</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(Maj::fraction(5, 1),    "5");</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(Maj::fraction(4, -9),   "-4/9");</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(Maj::fraction(-4, -9),  "4/9");</span>
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8070859" class="outline-4">
<h4 id="org8070859"><span class="section-number-4">4.5.3.</span> Floats</h4>
<div class="outline-text-4" id="text-4-5-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_number_float</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::float(2.0), <span style="color: #ce9178;">"2.0"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::float(0.5), <span style="color: #ce9178;">"0.5"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::float(20.2), <span style="color: #ce9178;">"20.2"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::float(-16.3), <span style="color: #ce9178;">"-16.3"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::float(-9.0), <span style="color: #ce9178;">"-9.0"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::float(-7.0), <span style="color: #ce9178;">"-7.0"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orge22bf2e" class="outline-4">
<h4 id="orge22bf2e"><span class="section-number-4">4.5.4.</span> Complexos</h4>
<div class="outline-text-4" id="text-4-5-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_number_complex</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(0),
                      <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #ce9178;">"0J5"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(3),
                      <span style="color: #4ec9b0;">Maj</span>::integer(1)),
         <span style="color: #ce9178;">"3J1"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3),
                      <span style="color: #4ec9b0;">Maj</span>::float(0.5)),
         <span style="color: #ce9178;">"2/3J0.5"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(-2),
                      <span style="color: #4ec9b0;">Maj</span>::integer(-1)),
         <span style="color: #ce9178;">"-2J-1"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::float(35.0),
                      <span style="color: #4ec9b0;">Maj</span>::fraction(-2, 9)),
         <span style="color: #ce9178;">"35.0J-2/9"</span>);
    );
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8933883" class="outline-3">
<h3 id="org8933883"><span class="section-number-3">4.6.</span> Listas</h3>
<div class="outline-text-3" id="text-4-6">
</div>
<div id="outline-container-orge9599f5" class="outline-4">
<h4 id="orge9599f5"><span class="section-number-4">4.6.1.</span> Listas pontuadas</h4>
<div class="outline-text-4" id="text-4-6-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_dotted_list</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">foo</span>  = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"foo"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">bar</span>  = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"bar"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">baz</span>  = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"baz"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">quux</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"quux"</span>);

    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #c586c0;">maj_dotted_list!</span>(foo.clone(), bar.clone()),
         <span style="color: #ce9178;">"(foo . bar)"</span>);
        (<span style="color: #c586c0;">maj_dotted_list!</span>(foo.clone(), bar.clone(),
                          baz.clone()),
         <span style="color: #ce9178;">"(foo bar . baz)"</span>);
        (<span style="color: #c586c0;">maj_dotted_list!</span>(foo.clone(), bar.clone(),
                          baz.clone(), quux.clone()),
         <span style="color: #ce9178;">"(foo bar baz . quux)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf443f81" class="outline-4">
<h4 id="orgf443f81"><span class="section-number-4">4.6.2.</span> Listas adequadas</h4>
<div class="outline-text-4" id="text-4-6-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_proper_list</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">foo</span>  = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"foo"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">bar</span>  = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"bar"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">baz</span>  = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"baz"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">quux</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"quux"</span>);

    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #c586c0;">maj_list!</span>(foo.clone()), <span style="color: #ce9178;">"(foo)"</span>);
        (<span style="color: #c586c0;">maj_list!</span>(foo.clone(), bar.clone()),
         <span style="color: #ce9178;">"(foo bar)"</span>);
        (<span style="color: #c586c0;">maj_list!</span>(foo.clone(), bar.clone(),
                   baz.clone()),
         <span style="color: #ce9178;">"(foo bar baz)"</span>);
        (<span style="color: #c586c0;">maj_list!</span>(foo.clone(), bar.clone(),
                   baz.clone(), quux.clone()),
         <span style="color: #ce9178;">"(foo bar baz quux)"</span>);
        (<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::quote(), foo.clone()),
         <span style="color: #ce9178;">"'foo"</span>);
        (<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::quasiquote(),
                   <span style="color: #c586c0;">maj_list!</span>(
                       foo.clone(),
                       <span style="color: #c586c0;">maj_list!</span>(
                           <span style="color: #4ec9b0;">Maj</span>::unquote(),
                           bar.clone()),
                       <span style="color: #c586c0;">maj_list!</span>(
                           <span style="color: #4ec9b0;">Maj</span>::unquote_splice(),
                           baz.clone()))),
         <span style="color: #ce9178;">"`(foo ,bar ,@baz)"</span>);
    );
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4e967de" class="outline-3">
<h3 id="org4e967de"><span class="section-number-3">4.7.</span> Vetores</h3>
<div class="outline-text-3" id="text-4-7">
</div>
<div id="outline-container-orgfac4303" class="outline-4">
<h4 id="orgfac4303"><span class="section-number-4">4.7.1.</span> Vetores de números inteiros</h4>
<div class="outline-text-4" id="text-4-7-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_vector_integers</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[]), <span style="color: #ce9178;">"[]"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3, 4]),
         <span style="color: #ce9178;">"[1 2 3 4]"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[-10, 2, 5, 93]),
         <span style="color: #ce9178;">"[-10 2 5 93]"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org59e4b88" class="outline-4">
<h4 id="org59e4b88"><span class="section-number-4">4.7.2.</span> Vetores de pontos flutuantes</h4>
<div class="outline-text-4" id="text-4-7-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_vector_float</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::vector_float(<span style="color: #c586c0;">vec!</span>[]), <span style="color: #ce9178;">"[]"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::vector_float(<span style="color: #c586c0;">vec!</span>[1.0, 2.0, 3.0, 4.0]),
         <span style="color: #ce9178;">"[1.0 2.0 3.0 4.0]"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::vector_float(<span style="color: #c586c0;">vec!</span>[-10.0, 2.0, 5.0, 93.0]),
         <span style="color: #ce9178;">"[-10.0 2.0 5.0 93.0]"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org15bfa2a" class="outline-4">
<h4 id="org15bfa2a"><span class="section-number-4">4.7.3.</span> Strings</h4>
<div class="outline-text-4" id="text-4-7-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_string</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">""</span>), <span style="color: #ce9178;">"\"\""</span>);
        (<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"abc"</span>), <span style="color: #ce9178;">"\"abc\""</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc26c0d3" class="outline-4">
<h4 id="orgc26c0d3"><span class="section-number-4">4.7.4.</span> Vetores de tipos quaisquer</h4>
<div class="outline-text-4" id="text-4-7-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_vector_any</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (<span style="color: #4ec9b0;">Maj</span>::vector_any(<span style="color: #c586c0;">vec!</span>[]), <span style="color: #ce9178;">"[]"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::vector_any(<span style="color: #c586c0;">vec!</span>[
            <span style="color: #4ec9b0;">Maj</span>::integer(1),
            <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3),
            <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                         <span style="color: #4ec9b0;">Maj</span>::integer(5)),
            <span style="color: #4ec9b0;">Maj</span>::integer(6),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                      <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>),
                      <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>))]),
         <span style="color: #ce9178;">"[1 2/3 2J5 6 (a b c)]"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::vector_any(
            <span style="color: #c586c0;">vec!</span>[<span style="color: #4ec9b0;">Maj</span>::vector_any(<span style="color: #c586c0;">vec!</span>[]),
                 <span style="color: #4ec9b0;">Maj</span>::vector_any(<span style="color: #c586c0;">vec!</span>[]),
                 <span style="color: #4ec9b0;">Maj</span>::vector_any(<span style="color: #c586c0;">vec!</span>[])]),
         <span style="color: #ce9178;">"[[] [] []]"</span>);
        (<span style="color: #4ec9b0;">Maj</span>::vector_any(
            <span style="color: #c586c0;">vec!</span>[<span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'H'</span>),
                 <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'e'</span>),
                 <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'l'</span>),
                 <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'l'</span>),
                 <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'o'</span>)]),
         <span style="color: #ce9178;">"[#\\H #\\e #\\l #\\l #\\o]"</span>);
    );
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge272689" class="outline-3">
<h3 id="orge272689"><span class="section-number-3">4.8.</span> Clausuras</h3>
<div class="outline-text-3" id="text-4-8">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_closure</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fst</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"fst"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">snd</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"snd"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">rest</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"rest"</span>);
    <span style="color: #c586c0;">multi_regex_test!</span>(
        state;
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit closure nil (x) ((* x x)))</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (fn (x)) {0x...}&gt;</span>
        (<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(), <span style="color: #4ec9b0;">Maj</span>::closure(), <span style="color: #4ec9b0;">Maj</span>::nil(),
                   <span style="color: #c586c0;">maj_list!</span>(x.clone()),
                   <span style="color: #c586c0;">maj_list!</span>(
                       <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*"</span>),
                                 x.clone(), x.clone()))),
         <span style="color: #4ec9b0;">RE_CLOSURE</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit closure nil nil (2))</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (fn nil) {0x...}&gt;</span>
        (<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(), <span style="color: #4ec9b0;">Maj</span>::closure(), <span style="color: #4ec9b0;">Maj</span>::nil(),
                   <span style="color: #4ec9b0;">Maj</span>::nil(),
                   <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(2))),
         <span style="color: #4ec9b0;">RE_CLOSURE</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit closure nil (x . rest) ((x)))</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (fn (x . rest)) {0x...}&gt;</span>
        (<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(), <span style="color: #4ec9b0;">Maj</span>::closure(), <span style="color: #4ec9b0;">Maj</span>::nil(),
                   <span style="color: #c586c0;">maj_dotted_list!</span>(x.clone(),
                                    rest.clone()),
                   <span style="color: #c586c0;">maj_list!</span>(<span style="color: #c586c0;">maj_list!</span>(x.clone()))),
         <span style="color: #4ec9b0;">RE_CLOSURE</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit closure nil (fst snd . rest) ((fst)))</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;function (fn (fst snd . rest)) {0x...}&gt;</span>
        (<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(), <span style="color: #4ec9b0;">Maj</span>::closure(), <span style="color: #4ec9b0;">Maj</span>::nil(),
                   <span style="color: #c586c0;">maj_dotted_list!</span>(fst.clone(),
                                    snd.clone(),
                                    rest.clone()),
                   <span style="color: #c586c0;">maj_list!</span>(<span style="color: #c586c0;">maj_list!</span>(fst.clone()))),
         <span style="color: #4ec9b0;">RE_CLOSURE</span>);
    );
    <span style="color: #c586c0;">test_fail_regex!</span>(state,
                     <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit 2)</span>
                     <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(), <span style="color: #4ec9b0;">Maj</span>::integer(2)),
                     <span style="color: #4ec9b0;">RE_CLOSURE</span>);
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb088d37" class="outline-3">
<h3 id="orgb088d37"><span class="section-number-3">4.9.</span> Primitivas</h3>
<div class="outline-text-3" id="text-4-9">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_primitive</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();

    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">prim_fetch</span> = |<span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span>: <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> <span style="color: #4ec9b0;">MajState</span>, name| {
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">sym</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, name);
        <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">result</span> =
            maj_eval(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, sym, <span style="color: #4ec9b0;">Maj</span>::nil());
        <span style="color: #c586c0;">assert!</span>(!maj_errorp(result.clone()).to_bool());
        result
    };
    
    <span style="color: #c586c0;">multi_regex_test!</span> {
        state;
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim cons required 2) =&gt; (defn cons (a b) ...)</span>
        (prim_fetch(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"cons"</span>), <span style="color: #4ec9b0;">RE_PRIMITIVE</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim coin nil nil) =&gt; (defn coin () ...)</span>
        (prim_fetch(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"coin"</span>), <span style="color: #4ec9b0;">RE_PRIMITIVE</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim print variadic 1) =&gt; (defn print (fmt . rest) ...)</span>
        (prim_fetch(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"print"</span>), <span style="color: #4ec9b0;">RE_PRIMITIVE</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim list variadic 0) =&gt; (defn list rest ...)</span>
        (prim_fetch(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"list"</span>), <span style="color: #4ec9b0;">RE_PRIMITIVE</span>);
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfe16b0d" class="outline-3">
<h3 id="orgfe16b0d"><span class="section-number-3">4.10.</span> Macros</h3>
<div class="outline-text-3" id="text-4-10">
<p>
Isso aqui  acaba sendo  um quase  um copypaste  descarado do  teste de
clausuras, mas com algumas modificações.
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_macro</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();

    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fst</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"fst"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">snd</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"snd"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">rest</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"rest"</span>);
    
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">macro_writer</span> = |lambda_list, body| {
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit macro (lit closure nil &lt;lambda-list&gt; &lt;body&gt;))</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">where &lt;body&gt; is also a list of many expressions</span>
        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(), <span style="color: #4ec9b0;">Maj</span>::macro_sym(),
                  <span style="color: #c586c0;">maj_list!</span>(
                      <span style="color: #4ec9b0;">Maj</span>::lit(),
                      <span style="color: #4ec9b0;">Maj</span>::closure(),
                      <span style="color: #4ec9b0;">Maj</span>::nil(),
                      lambda_list, body))
    };

    <span style="color: #c586c0;">multi_regex_test!</span>(
        state;
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;macro (mac (x)) {0x...}&gt;</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(mac (x) x)</span>
        (macro_writer(
            <span style="color: #c586c0;">maj_list!</span>(x.clone()),
            <span style="color: #c586c0;">maj_list!</span>(x.clone())),
         <span style="color: #4ec9b0;">RE_MACRO</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;macro (mac nil) {0x...}&gt;</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(mac () x)</span>
        (macro_writer(
            <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(x.clone())),
         <span style="color: #4ec9b0;">RE_MACRO</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;macro (mac (x . rest)) {0x...}&gt;</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(mac (x . rest) (x rest))</span>
        (macro_writer(
            <span style="color: #c586c0;">maj_dotted_list!</span>(x.clone(), rest.clone()),
            <span style="color: #c586c0;">maj_list!</span>(x.clone(), rest.clone())),
         <span style="color: #4ec9b0;">RE_MACRO</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">#&lt;macro (mac (fst snd . rest)) {0x...}&gt;</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(mac (fst snd . rest) (fst snd rest))</span>
        (macro_writer(
            <span style="color: #c586c0;">maj_dotted_list!</span>(fst.clone(), snd.clone(),
                             rest.clone()),
            <span style="color: #c586c0;">maj_list!</span>(fst.clone(), snd.clone(), rest.clone())),
         <span style="color: #4ec9b0;">RE_MACRO</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org2603aee" class="outline-3">
<h3 id="org2603aee"><span class="section-number-3">4.11.</span> Erros</h3>
<div class="outline-text-3" id="text-4-11">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_error</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();

    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">error_writer</span> = |format, args| {
        <span style="color: #c586c0;">maj_dotted_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::lit(), <span style="color: #4ec9b0;">Maj</span>::error(),
            format, args)
    };
    
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (error_writer(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello"</span>),
                      <span style="color: #4ec9b0;">Maj</span>::nil()),
         <span style="color: #ce9178;">"Hello"</span>);
        (error_writer(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello, {}"</span>),
                      <span style="color: #c586c0;">maj_list!</span>(
                          <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"world"</span>))),
         <span style="color: #ce9178;">"Hello, world"</span>);
        (error_writer(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"{} + {} = {}"</span>),
                      <span style="color: #c586c0;">maj_list!</span>(
                          <span style="color: #4ec9b0;">Maj</span>::integer(1),
                          <span style="color: #4ec9b0;">Maj</span>::integer(2),
                          <span style="color: #4ec9b0;">Maj</span>::integer(3))),
         <span style="color: #ce9178;">"1 + 2 = 3"</span>);
        (error_writer(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"{} is not a list such as {}"</span>),
                      <span style="color: #c586c0;">maj_list!</span>(
                          <span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(2)),
                          <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(2)))),
         <span style="color: #ce9178;">"(1 . 2) is not a list such as (1 2)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org33d147a" class="outline-3">
<h3 id="org33d147a"><span class="section-number-3">4.12.</span> <span class="todo TODO">TODO</span> Pretty-printing</h3>
<div class="outline-text-3" id="text-4-12">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">formatter_prettyprinting</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3f68952" class="outline-2">
<h2 id="org3f68952"><span class="section-number-2">5.</span> Coerções numéricas</h2>
<div class="outline-text-2" id="text-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">number_coercion</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_number_coerce;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">integer</span>  = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"integer"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fraction</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"fraction"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">float</span>    = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"float"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">complex</span>  = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"complex"</span>);

    <span style="color: #c586c0;">multi_test!</span>(
        state;
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Integer coercion</span>
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, integer.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #ce9178;">"5"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, float.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #ce9178;">"5.0"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, fraction.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #ce9178;">"5/1"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, complex.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #ce9178;">"5J0.0"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Float coercion</span>
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, integer.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::float(5.3)),
         <span style="color: #ce9178;">"5"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, float.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::float(5.3)),
         <span style="color: #ce9178;">"5.3"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, fraction.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::float(5.3)),
         <span style="color: #ce9178;">"53/10"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, complex.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::float(5.3)),
         <span style="color: #ce9178;">"5.3J0.0"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Fraction coercion</span>
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, integer.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::fraction(3, 2)),
         <span style="color: #ce9178;">"1"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, float.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::fraction(3, 2)),
         <span style="color: #ce9178;">"1.5"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, fraction.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::fraction(3, 2)),
         <span style="color: #ce9178;">"3/2"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, complex.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::fraction(3, 2)),
         <span style="color: #ce9178;">"3/2J0.0"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Complex coercion</span>
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, integer.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::complex(
                               <span style="color: #4ec9b0;">Maj</span>::integer(3),
                               <span style="color: #4ec9b0;">Maj</span>::integer(2))),
         <span style="color: #ce9178;">"3"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, float.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::complex(
                               <span style="color: #4ec9b0;">Maj</span>::integer(3),
                               <span style="color: #4ec9b0;">Maj</span>::integer(2))),
         <span style="color: #ce9178;">"3.0"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, fraction.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::complex(
                               <span style="color: #4ec9b0;">Maj</span>::integer(3),
                               <span style="color: #4ec9b0;">Maj</span>::integer(2))),
         <span style="color: #ce9178;">"3/1"</span>);
        (maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, complex.clone(),
                           <span style="color: #4ec9b0;">Maj</span>::complex(
                               <span style="color: #4ec9b0;">Maj</span>::integer(3),
                               <span style="color: #4ec9b0;">Maj</span>::integer(2))),
         <span style="color: #ce9178;">"3J2"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org6efe104" class="outline-2">
<h2 id="org6efe104"><span class="section-number-2">6.</span> Funções</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org8f1a544" class="outline-3">
<h3 id="org8f1a544"><span class="section-number-3">6.1.</span> Predicados</h3>
<div class="outline-text-3" id="text-6-1">
</div>
<div id="outline-container-org73b278c" class="outline-4">
<h4 id="org73b278c"><span class="section-number-4">6.1.1.</span> <code>symbolp</code></h4>
<div class="outline-text-4" id="text-6-1-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_symbolp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_symbolp;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_symbolp(<span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #569cd6;">true</span>);
        (maj_symbolp(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3)), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org6cd10b9" class="outline-4">
<h4 id="org6cd10b9"><span class="section-number-4">6.1.2.</span> <code>eq</code></h4>
<div class="outline-text-4" id="text-6-1-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_eq</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_eq;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_eq(<span style="color: #4ec9b0;">Maj</span>::t(), <span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #569cd6;">true</span>);
        (maj_eq(<span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_eq(<span style="color: #4ec9b0;">Maj</span>::t(), <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">false</span>);
        (maj_eq(<span style="color: #4ec9b0;">Maj</span>::integer(20), <span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org5a35015" class="outline-4">
<h4 id="org5a35015"><span class="section-number-4">6.1.3.</span> <code>nilp</code></h4>
<div class="outline-text-4" id="text-6-1-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_nilp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_nilp;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_nilp(<span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_nilp(<span style="color: #4ec9b0;">Maj</span>::integer(5)), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org4785bf6" class="outline-4">
<h4 id="org4785bf6"><span class="section-number-4">6.1.4.</span> <code>consp</code></h4>
<div class="outline-text-4" id="text-6-1-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_consp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_consp;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_consp(<span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                             <span style="color: #4ec9b0;">Maj</span>::integer(3))),
         <span style="color: #569cd6;">true</span>);
        (maj_consp(<span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                             <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>))),
         <span style="color: #569cd6;">true</span>);
        (maj_consp(<span style="color: #4ec9b0;">Maj</span>::integer(10)), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgab21dbc" class="outline-4">
<h4 id="orgab21dbc"><span class="section-number-4">6.1.5.</span> <code>atomp</code></h4>
<div class="outline-text-4" id="text-6-1-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_atomp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_atomp;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_atomp(<span style="color: #4ec9b0;">Maj</span>::integer(1)), <span style="color: #569cd6;">true</span>);
        (maj_atomp(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>)), <span style="color: #569cd6;">true</span>);
        (maj_atomp(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                             <span style="color: #4ec9b0;">Maj</span>::integer(2),
                             <span style="color: #4ec9b0;">Maj</span>::integer(3))),
         <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org72bd964" class="outline-4">
<h4 id="org72bd964"><span class="section-number-4">6.1.6.</span> <code>charp</code></h4>
<div class="outline-text-4" id="text-6-1-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_charp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_charp;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_charp(<span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'a'</span>)), <span style="color: #569cd6;">true</span>);
        (maj_charp(<span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orge6b36d6" class="outline-4">
<h4 id="orge6b36d6"><span class="section-number-4">6.1.7.</span> <code>char=</code></h4>
<div class="outline-text-4" id="text-6-1-7">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_char_equals</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_char_equals;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">small_a</span> = <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'a'</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">big_a</span>   = <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'A'</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">bel</span>     = <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'\x07'</span>);
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_char_equals(small_a.clone(), small_a.clone()),
         <span style="color: #569cd6;">true</span>);
        (maj_char_equals(small_a.clone(), big_a.clone()),
         <span style="color: #569cd6;">false</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_char_equals(small_a.clone(), <span style="color: #4ec9b0;">Maj</span>::t());
        maj_char_equals(<span style="color: #4ec9b0;">Maj</span>::nil(), bel);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd8bf192" class="outline-4">
<h4 id="orgd8bf192"><span class="section-number-4">6.1.8.</span> <code>streamp</code></h4>
<div class="outline-text-4" id="text-6-1-8">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_streamp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_streamp;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::<span style="color: #569cd6;">types</span>::<span style="color: #4ec9b0;">MajStreamDirection</span>;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">ostream</span> = <span style="color: #4ec9b0;">Maj</span>::stream(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
        <span style="color: #ce9178;">"test-streams-out.txt"</span>,
        <span style="color: #4ec9b0;">MajStreamDirection</span>::<span style="color: #4ec9b0;">Out</span>).unwrap();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">stdout</span> = state.make_stream_stdout();
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_streamp(ostream.clone()), <span style="color: #569cd6;">true</span>);
        (maj_streamp(stdout), <span style="color: #569cd6;">true</span>);
        (maj_streamp(<span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #569cd6;">false</span>);
    );
    state.close_stream(ostream);
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdebaa75" class="outline-4">
<h4 id="orgdebaa75"><span class="section-number-4">6.1.9.</span> <code>numberp</code></h4>
<div class="outline-text-4" id="text-6-1-9">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_numberp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_numberp;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_numberp(<span style="color: #4ec9b0;">Maj</span>::integer(2)), <span style="color: #569cd6;">true</span>);
        (maj_numberp(<span style="color: #4ec9b0;">Maj</span>::float(0.5)), <span style="color: #569cd6;">true</span>);
        (maj_numberp(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3)), <span style="color: #569cd6;">true</span>);
        (maj_numberp(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(0),
                                  <span style="color: #4ec9b0;">Maj</span>::float(2.0))),
         <span style="color: #569cd6;">true</span>);
        (maj_numberp(<span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org02e9675" class="outline-4">
<h4 id="org02e9675"><span class="section-number-4">6.1.10.</span> <code>integerp</code></h4>
<div class="outline-text-4" id="text-6-1-10">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_integerp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_integerp;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_integerp(<span style="color: #4ec9b0;">Maj</span>::integer(2)), <span style="color: #569cd6;">true</span>);
        (maj_integerp(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3)), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf200db8" class="outline-4">
<h4 id="orgf200db8"><span class="section-number-4">6.1.11.</span> <code>floatp</code></h4>
<div class="outline-text-4" id="text-6-1-11">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_floatp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_floatp;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_floatp(<span style="color: #4ec9b0;">Maj</span>::float(2.5)), <span style="color: #569cd6;">true</span>);
        (maj_floatp(<span style="color: #4ec9b0;">Maj</span>::float(2.0)), <span style="color: #569cd6;">true</span>);
        (maj_floatp(<span style="color: #4ec9b0;">Maj</span>::float(0.5)), <span style="color: #569cd6;">true</span>);
        (maj_floatp(<span style="color: #4ec9b0;">Maj</span>::integer(3)), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org6b2e8e9" class="outline-4">
<h4 id="org6b2e8e9"><span class="section-number-4">6.1.12.</span> <code>fractionp</code></h4>
<div class="outline-text-4" id="text-6-1-12">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_fractionp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_fractionp;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_fractionp(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3)), <span style="color: #569cd6;">true</span>);
        (maj_fractionp(<span style="color: #4ec9b0;">Maj</span>::fraction(5, 8)), <span style="color: #569cd6;">true</span>);
        (maj_fractionp(<span style="color: #4ec9b0;">Maj</span>::integer(8)), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd9fe47" class="outline-4">
<h4 id="orgdd9fe47"><span class="section-number-4">6.1.13.</span> <code>complexp</code></h4>
<div class="outline-text-4" id="text-6-1-13">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_complexp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_complexp;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_complexp(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::float(0.5),
                                   <span style="color: #4ec9b0;">Maj</span>::integer(1))),
         <span style="color: #569cd6;">true</span>);
        (maj_complexp(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(-10),
                                   <span style="color: #4ec9b0;">Maj</span>::integer(-3))),
         <span style="color: #569cd6;">true</span>);
        (maj_complexp(<span style="color: #4ec9b0;">Maj</span>::integer(5)), <span style="color: #569cd6;">false</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(maj_complexp(Maj::complex(Maj::integer(5),</span>
        <span style="color: #6a9955;">//                            </span><span style="color: #6a9955;">Maj::integer(0))),</span>
        <span style="color: #6a9955;">//  </span><span style="color: #6a9955;">false);</span>
        (maj_complexp(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(5),
                                   <span style="color: #4ec9b0;">Maj</span>::float(0.0))),
         <span style="color: #569cd6;">true</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b2cacb" class="outline-4">
<h4 id="org7b2cacb"><span class="section-number-4">6.1.14.</span> <code>vectorp</code></h4>
<div class="outline-text-4" id="text-6-1-14">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_vectorp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_vectorp;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_vectorp(
            <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3])), <span style="color: #569cd6;">true</span>);
        (maj_vectorp(<span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org37c161f" class="outline-4">
<h4 id="org37c161f"><span class="section-number-4">6.1.15.</span> <code>id</code></h4>
<div class="outline-text-4" id="text-6-1-15">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_id</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_id;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_id(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>)),
         <span style="color: #569cd6;">true</span>);
        (maj_id(<span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'c'</span>),
                <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'c'</span>)),
         <span style="color: #569cd6;">true</span>);
        (maj_id(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                          <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>)),
                <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                          <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>))),
         <span style="color: #569cd6;">false</span>);
        (maj_id(<span style="color: #4ec9b0;">Maj</span>::integer(5), <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org938c045" class="outline-4">
<h4 id="org938c045"><span class="section-number-4">6.1.16.</span> <code>proper-list-p</code></h4>
<div class="outline-text-4" id="text-6-1-16">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_proper_list_p</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_proper_list_p;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">b</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">c</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">d</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"d"</span>);
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_proper_list_p(
            <span style="color: #c586c0;">maj_list!</span>(a.clone(),
                      b.clone(),
                      c.clone(),
                      d.clone())),
         <span style="color: #569cd6;">true</span>);
        (maj_proper_list_p(
            <span style="color: #c586c0;">maj_dotted_list!</span>(a, b, c, d)),
         <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org947f45c" class="outline-4">
<h4 id="org947f45c"><span class="section-number-4">6.1.17.</span> <code>stringp</code></h4>
<div class="outline-text-4" id="text-6-1-17">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_stringp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_stringp;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_vector;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'a'</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">b</span> = <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'b'</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">c</span> = <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'c'</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">charlist</span> = <span style="color: #c586c0;">maj_list!</span>(a.clone(), b.clone(), c.clone());
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">charvec</span> = maj_vector(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, charlist.clone());
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">charvec2</span> = <span style="color: #4ec9b0;">Maj</span>::vector_any(<span style="color: #c586c0;">vec!</span>[a, b, c]);
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_stringp(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"abc"</span>)), <span style="color: #569cd6;">true</span>);
        (maj_stringp(charvec), <span style="color: #569cd6;">true</span>);
        (maj_stringp(charlist), <span style="color: #569cd6;">false</span>);
        (maj_stringp(charvec2), <span style="color: #569cd6;">false</span>);
        (maj_stringp(<span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #569cd6;">false</span>);
    );  
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org9e0dc54" class="outline-4">
<h4 id="org9e0dc54"><span class="section-number-4">6.1.18.</span> <code>literalp</code></h4>
<div class="outline-text-4" id="text-6-1-18">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_literalp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_literalp;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">b</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">c</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>);
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_literalp(
            <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit closure nil (x) ((* x x)))</span>
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(),
                      <span style="color: #4ec9b0;">Maj</span>::closure(),
                      <span style="color: #4ec9b0;">Maj</span>::nil(),
                      <span style="color: #c586c0;">maj_list!</span>(x.clone()),
                      <span style="color: #c586c0;">maj_list!</span>(<span style="color: #c586c0;">maj_list!</span>(
                          <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*"</span>),
                          x.clone(), x)))),
         <span style="color: #569cd6;">true</span>);
        (maj_literalp(<span style="color: #c586c0;">maj_list!</span>(a, b, c)), <span style="color: #569cd6;">false</span>);
        (maj_literalp(<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::lit(),
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"blah"</span>))),
         <span style="color: #569cd6;">true</span>);       
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org21f251c" class="outline-4">
<h4 id="org21f251c"><span class="section-number-4">6.1.19.</span> <code>primitivep</code></h4>
<div class="outline-text-4" id="text-6-1-19">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_primitivep</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_primitivep;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Emulate internal definitions of primitivep and +</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim primitivep required 1)</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">primitivep</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::prim(),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"primitivep"</span>),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"required"</span>),
        <span style="color: #4ec9b0;">Maj</span>::integer(1));
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim + variadic 0)</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">plus</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::prim(),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"+"</span>),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"variadic"</span>),
        <span style="color: #4ec9b0;">Maj</span>::integer(0));
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Emulate closure definition on top-level</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit closure nil (x) ((+ x x)))</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">closure</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::closure(),
        <span style="color: #4ec9b0;">Maj</span>::nil(),
        <span style="color: #c586c0;">maj_list!</span>(x.clone()),
        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"+"</span>),
            x.clone(), x)));
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_primitivep(primitivep), <span style="color: #569cd6;">true</span>);
        (maj_primitivep(closure), <span style="color: #569cd6;">false</span>);
        (maj_primitivep(plus), <span style="color: #569cd6;">true</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfbc3e78" class="outline-4">
<h4 id="orgfbc3e78"><span class="section-number-4">6.1.20.</span> <code>closurep</code></h4>
<div class="outline-text-4" id="text-6-1-20">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_closurep</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_closurep;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Emulate closure definition on top-level</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit closure nil (x) ((* x x)))</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">closure</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::closure(),
        <span style="color: #4ec9b0;">Maj</span>::nil(),
        <span style="color: #c586c0;">maj_list!</span>(x.clone()),
        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*"</span>),
            x.clone(), x)));
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Emulate internal definitions of cons and +</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim cons required 2)</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">cons</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::prim(),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"cons"</span>),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"required"</span>),
        <span style="color: #4ec9b0;">Maj</span>::integer(2));
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim + variadic 0)</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">plus</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::prim(),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"+"</span>),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"variadic"</span>),
        <span style="color: #4ec9b0;">Maj</span>::integer(0));
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_closurep(closure), <span style="color: #569cd6;">true</span>);
        (maj_closurep(
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(),
                      <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"blah"</span>))),
         <span style="color: #569cd6;">false</span>);
        (maj_closurep(cons), <span style="color: #569cd6;">false</span>);
        (maj_closurep(plus), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org6820f33" class="outline-4">
<h4 id="org6820f33"><span class="section-number-4">6.1.21.</span> <code>functionp</code></h4>
<div class="outline-text-4" id="text-6-1-21">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_functionp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_functionp;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Emulate closure definition on top-level</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit closure nil (x) ((* x x)))</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">closure</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::closure(),
        <span style="color: #4ec9b0;">Maj</span>::nil(),
        <span style="color: #c586c0;">maj_list!</span>(x.clone()),
        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*"</span>),
            x.clone(), x)));
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Emulate internal definitions of cons and +</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim cons required 2)</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">cons</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::prim(),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"cons"</span>),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"required"</span>),
        <span style="color: #4ec9b0;">Maj</span>::integer(2));
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim + variadic 0)</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">plus</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::prim(),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"+"</span>),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"variadic"</span>),
        <span style="color: #4ec9b0;">Maj</span>::integer(0));
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_functionp(closure), <span style="color: #569cd6;">true</span>);
        (maj_functionp(plus), <span style="color: #569cd6;">true</span>);
        (maj_functionp(cons), <span style="color: #569cd6;">true</span>);
        (maj_functionp(<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::lit(),
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"blah"</span>))),
         <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgadbbe20" class="outline-4">
<h4 id="orgadbbe20"><span class="section-number-4">6.1.22.</span> <code>macrop</code></h4>
<div class="outline-text-4" id="text-6-1-22">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_macrop</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_macrop;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span>         = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Emulate definition of (mac (x) `(list ,x)) on top level</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit macro (lit closure nil (x) ((quasiquote (list (unquote x))))))</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">themacro</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"macro"</span>),
        <span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::lit(),
            <span style="color: #4ec9b0;">Maj</span>::closure(),
            <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(x.clone()),
            <span style="color: #c586c0;">maj_list!</span>(
                <span style="color: #c586c0;">maj_list!</span>(
                    <span style="color: #4ec9b0;">Maj</span>::quasiquote(),
                    <span style="color: #c586c0;">maj_list!</span>(
                        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"list"</span>),
                        <span style="color: #c586c0;">maj_list!</span>(
                            <span style="color: #4ec9b0;">Maj</span>::unquote(),
                            x.clone()))))));
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Emulate internal definitions of cons and +</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim cons required 2)</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">cons</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::prim(),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"cons"</span>),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"required"</span>),
        <span style="color: #4ec9b0;">Maj</span>::integer(2));
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit prim + variadic 0)</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">plus</span> = <span style="color: #c586c0;">maj_list!</span>(
        <span style="color: #4ec9b0;">Maj</span>::lit(),
        <span style="color: #4ec9b0;">Maj</span>::prim(),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"+"</span>),
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"variadic"</span>),
        <span style="color: #4ec9b0;">Maj</span>::integer(0));
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_macrop(themacro), <span style="color: #569cd6;">true</span>);
        (maj_macrop(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(),
                              <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"blah"</span>))),
         <span style="color: #569cd6;">false</span>);
        (maj_macrop(cons), <span style="color: #569cd6;">false</span>);
        (maj_macrop(plus), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf137614" class="outline-4">
<h4 id="orgf137614"><span class="section-number-4">6.1.23.</span> <code>errorp</code></h4>
<div class="outline-text-4" id="text-6-1-23">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_errorp</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_errorp;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_err;
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_errorp(maj_err(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Some error"</span>),
                            <span style="color: #4ec9b0;">Maj</span>::nil())),
         <span style="color: #569cd6;">true</span>);
        (maj_errorp(maj_err(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Some other error"</span>),
                            <span style="color: #4ec9b0;">Maj</span>::nil())),
         <span style="color: #569cd6;">true</span>);
        (maj_errorp(<span style="color: #4ec9b0;">Maj</span>::integer(2)), <span style="color: #569cd6;">false</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgafe7b12" class="outline-4">
<h4 id="orgafe7b12"><span class="section-number-4">6.1.24.</span> <code>zerop</code></h4>
<div class="outline-text-4" id="text-6-1-24">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">predicates_zerop</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_zerop;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_zerop(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::float(0.0)), <span style="color: #569cd6;">true</span>);
        (maj_zerop(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::fraction(0, 1)), <span style="color: #569cd6;">true</span>);
        (maj_zerop(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::integer(0)), <span style="color: #569cd6;">true</span>);
        (maj_zerop(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::integer(5)), <span style="color: #569cd6;">false</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(
        maj_zerop(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::t()));
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgece8471" class="outline-3">
<h3 id="orgece8471"><span class="section-number-3">6.2.</span> Outras funções primitivas</h3>
<div class="outline-text-3" id="text-6-2">
</div>
<div id="outline-container-org8ed43a9" class="outline-4">
<h4 id="org8ed43a9"><span class="section-number-4">6.2.1.</span> <code>cons</code></h4>
<div class="outline-text-4" id="text-6-2-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_cons</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{ maj_cons, maj_err };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_cons(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                  <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>)),
         <span style="color: #ce9178;">"(a . b)"</span>);
        (maj_cons(<span style="color: #4ec9b0;">Maj</span>::integer(1), <span style="color: #4ec9b0;">Maj</span>::integer(2)),
         <span style="color: #ce9178;">"(1 . 2)"</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_cons(maj_err(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Some error"</span>),
                         <span style="color: #4ec9b0;">Maj</span>::nil()),
                 <span style="color: #4ec9b0;">Maj</span>::t());
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orge5d7cdd" class="outline-4">
<h4 id="orge5d7cdd"><span class="section-number-4">6.2.2.</span> <code>car</code></h4>
<div class="outline-text-4" id="text-6-2-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_car</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_cons
    };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_car(<span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                           <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>))),
         <span style="color: #ce9178;">"a"</span>);
        (maj_car(maj_cons(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>),
                          <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"d"</span>))),
         <span style="color: #ce9178;">"c"</span>);
        (maj_car(<span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org043e6bf" class="outline-4">
<h4 id="org043e6bf"><span class="section-number-4">6.2.3.</span> <code>cdr</code></h4>
<div class="outline-text-4" id="text-6-2-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_cdr</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_cdr, maj_cons
    };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_cdr(<span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                           <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>))),
         <span style="color: #ce9178;">"b"</span>);
        (maj_cdr(maj_cons(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>),
                          <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"d"</span>))),
         <span style="color: #ce9178;">"d"</span>);
        (maj_cdr(<span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8cc3998" class="outline-4">
<h4 id="org8cc3998"><span class="section-number-4">6.2.4.</span> <code>copy</code></h4>
<div class="outline-text-4" id="text-6-2-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_copy</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::{
        <span style="color: #569cd6;">primitives</span>::{
            maj_copy, maj_cons, maj_cdr
        },
        <span style="color: #569cd6;">predicates</span>::maj_id
    };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = maj_cons(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                     <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>));
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">y</span> = maj_copy(x.clone());

    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (x.clone(), <span style="color: #ce9178;">"(a . b)"</span>);
        (y.clone(), <span style="color: #ce9178;">"(a . b)"</span>);
    );
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_id(x.clone(), y.clone()), <span style="color: #569cd6;">false</span>);
        (maj_id(maj_car(x.clone()), maj_car(y.clone())),
         <span style="color: #569cd6;">true</span>);
        (maj_id(maj_cdr(x.clone()), maj_cdr(y.clone())),
         <span style="color: #569cd6;">true</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_copy(<span style="color: #4ec9b0;">Maj</span>::t()));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org29804e0" class="outline-4">
<h4 id="org29804e0"><span class="section-number-4">6.2.5.</span> <code>length</code></h4>
<div class="outline-text-4" id="text-6-2-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_length</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_length;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_length(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                              <span style="color: #4ec9b0;">Maj</span>::integer(2),
                              <span style="color: #4ec9b0;">Maj</span>::integer(3),
                              <span style="color: #4ec9b0;">Maj</span>::integer(4))),
         <span style="color: #ce9178;">"4"</span>);
        (maj_length(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                              <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>),
                              <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>))),
         <span style="color: #ce9178;">"3"</span>);
        (maj_length(<span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"0"</span>);
        (maj_length(<span style="color: #c586c0;">maj_dotted_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                     <span style="color: #4ec9b0;">Maj</span>::integer(2),
                                     <span style="color: #4ec9b0;">Maj</span>::integer(3))),
         <span style="color: #ce9178;">"2"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_length(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>)));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org01f852e" class="outline-4">
<h4 id="org01f852e"><span class="section-number-4">6.2.6.</span> <code>depth</code></h4>
<div class="outline-text-4" id="text-6-2-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_depth</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_depth;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_depth(<span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"0"</span>);
        (maj_depth(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::nil())), <span style="color: #ce9178;">"1"</span>);
        (maj_depth(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1)))),
         <span style="color: #ce9178;">"2"</span>);
        (maj_depth(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                             <span style="color: #4ec9b0;">Maj</span>::integer(2),
                             <span style="color: #4ec9b0;">Maj</span>::integer(3),
                             <span style="color: #4ec9b0;">Maj</span>::integer(4),
                             <span style="color: #4ec9b0;">Maj</span>::integer(5))),
         <span style="color: #ce9178;">"5"</span>);
        (maj_depth(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                             <span style="color: #4ec9b0;">Maj</span>::integer(2),
                             <span style="color: #4ec9b0;">Maj</span>::integer(3),
                             <span style="color: #4ec9b0;">Maj</span>::integer(4),
                             <span style="color: #4ec9b0;">Maj</span>::integer(5),
                             <span style="color: #4ec9b0;">Maj</span>::integer(6))),
         <span style="color: #ce9178;">"6"</span>);
        (maj_depth(<span style="color: #c586c0;">maj_dotted_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(2),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(3),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(4),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(5),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(6))),
         <span style="color: #ce9178;">"5"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_depth(<span style="color: #4ec9b0;">Maj</span>::integer(1)));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9ee5e5" class="outline-4">
<h4 id="orgb9ee5e5"><span class="section-number-4">6.2.7.</span> <code>type</code></h4>
<div class="outline-text-4" id="text-6-2-7">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_type</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_type;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">b</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">c</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">stdout</span> = state.make_stream_stdout();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(1)),
         <span style="color: #ce9178;">"integer"</span>);
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::float(2.0)),
         <span style="color: #ce9178;">"float"</span>);
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, a.clone()),
         <span style="color: #ce9178;">"symbol"</span>);
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil()),
         <span style="color: #ce9178;">"symbol"</span>);
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3)),
         <span style="color: #ce9178;">"fraction"</span>);
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #c586c0;">maj_list!</span>(a, b, c)),
         <span style="color: #ce9178;">"cons"</span>);
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'L'</span>)),
         <span style="color: #ce9178;">"char"</span>);
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, stdout), <span style="color: #ce9178;">"stream"</span>);
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                           <span style="color: #4ec9b0;">Maj</span>::integer(5))),
         <span style="color: #ce9178;">"complex"</span>);
        (maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3])),
         <span style="color: #ce9178;">"vector"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd666b1" class="outline-4">
<h4 id="orgcd666b1"><span class="section-number-4">6.2.8.</span> <code>intern</code></h4>
<div class="outline-text-4" id="text-6-2-8">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_intern</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_intern;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_intern(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"blah"</span>)),
         <span style="color: #ce9178;">"blah"</span>);
        (maj_intern(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"foo"</span>)),
         <span style="color: #ce9178;">"foo"</span>);
        (maj_intern(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">""</span>)),
         <span style="color: #ce9178;">"nil"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_intern(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, a));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc419275" class="outline-4">
<h4 id="orgc419275"><span class="section-number-4">6.2.9.</span> <code>name</code></h4>
<div class="outline-text-4" id="text-6-2-9">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_name</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_name;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">foo</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"foo"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">thing</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"thing"</span>);
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_name(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #ce9178;">"\"t\""</span>);
        (maj_name(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, foo), <span style="color: #ce9178;">"\"foo\""</span>);
        (maj_name(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, thing), <span style="color: #ce9178;">"\"thing\""</span>);
        (maj_name(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"\"nil\""</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_name(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Blah"</span>)));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org6d5b79b" class="outline-4">
<h4 id="org6d5b79b"><span class="section-number-4">6.2.10.</span> <span class="todo TODO">TODO</span> <code>get-environment</code></h4>
<div class="outline-text-4" id="text-6-2-10">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_get_environment</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::<span style="color: #569cd6;">environment</span>::maj_env_push;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_get_environment;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">y</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"y"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">plus</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"+"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">sum_test</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"sum-test"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">global</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"global"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">lexical</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"lexical"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">blah</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"blah"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">env</span> = <span style="color: #4ec9b0;">Maj</span>::nil();
    env = maj_env_push(env, x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(5));
    env = maj_env_push(env, y.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(6));
    <span style="color: #c586c0;">multi_regex_test!</span>(
        state;
        (maj_get_environment(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, global, env.clone()),
         <span style="color: #4ec9b0;">RE_ENVIRONMENT</span>);
        (maj_get_environment(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, lexical.clone(), env.clone()),
         <span style="color: #4ec9b0;">RE_ENVIRONMENT</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_get_environment(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, blah, env.clone()));
    test_<span style="color: #c586c0;">format!</span>(
        state,
        {
            <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">lexenv</span> = maj_get_environment(
                <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, lexical, env.clone());
            <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">newenv</span> = maj_env_push(
                env.clone(),
                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"env"</span>),
                lexenv);
            state.push(sum_test.clone(),
                       <span style="color: #c586c0;">maj_list!</span>(
                           <span style="color: #c586c0;">maj_list!</span>(
                               <span style="color: #4ec9b0;">Maj</span>::quasiquote(),
                               <span style="color: #c586c0;">maj_list!</span>(
                                   <span style="color: #4ec9b0;">Maj</span>::lit(),
                                   <span style="color: #4ec9b0;">Maj</span>::closure(),
                                   newenv.clone(),
                                   <span style="color: #4ec9b0;">Maj</span>::nil(),
                                   <span style="color: #c586c0;">maj_list!</span>(
                                       <span style="color: #c586c0;">maj_list!</span>(
                                           plus, x, y))))));
            sum_test.clone() <span style="color: #6a9955;">// </span><span style="color: #6a9955;">TODO: Replace with lookup</span>
        }, <span style="color: #ce9178;">"sum-test"</span>); <span style="color: #6a9955;">// </span><span style="color: #6a9955;">TODO: Return a closure here and check</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">TODO: Add application (sum-test)</span>
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeae845d" class="outline-4">
<h4 id="orgeae845d"><span class="section-number-4">6.2.11.</span> <code>coin</code></h4>
<div class="outline-text-4" id="text-6-2-11">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_coin</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_coin;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">No better way to test this... just toss a coin</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">for a few times and check whether the output</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">is either t or nil.</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">In the future, we might want to test the distribution</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">of these values.</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">n</span> = 100;
    <span style="color: #569cd6;">for</span> <span style="color: #9cdcfe;">_</span> <span style="color: #569cd6;">in</span> 0..n {
        <span style="color: #c586c0;">test_regex!</span>(state, maj_coin(), <span style="color: #ce9178;">r"^t|nil$"</span>);
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org94f821d" class="outline-4">
<h4 id="org94f821d"><span class="section-number-4">6.2.12.</span> <code>sys</code></h4>
<div class="outline-text-4" id="text-6-2-12">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_sys</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_sys;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_sys(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"true"</span>), <span style="color: #4ec9b0;">Maj</span>::nil()),  <span style="color: #ce9178;">"0"</span>);
        (maj_sys(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"false"</span>), <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"1"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org094f991" class="outline-4">
<h4 id="org094f991"><span class="section-number-4">6.2.13.</span> <code>format</code></h4>
<div class="outline-text-4" id="text-6-2-13">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_format</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_format_prim,
        maj_type
    };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::fraction(1, 2);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">xtype</span> = maj_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, x.clone());
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_format_prim(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello world"</span>),
                         <span style="color: #4ec9b0;">Maj</span>::nil()),
         <span style="color: #ce9178;">"\"Hello world\""</span>);
        (maj_format_prim(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"The number five: {}"</span>),
                         <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(5))),
         <span style="color: #ce9178;">"\"The number five: 5\""</span>);
        (maj_format_prim(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"The floating point {} is nice"</span>),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::float(2.0))),
         <span style="color: #ce9178;">"\"The floating point 2.0 is nice\""</span>);
        (maj_format_prim(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"The number {} has a subtype {}"</span>),
            <span style="color: #c586c0;">maj_list!</span>(x, xtype)),
         <span style="color: #ce9178;">"\"The number 1/2 has a subtype fraction\""</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_format_prim(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello {}"</span>),
                        <span style="color: #4ec9b0;">Maj</span>::nil());
        maj_format_prim(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello {"</span>),
                        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"World"</span>)));
        maj_format_prim(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello }"</span>),
                        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"World"</span>)));
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org3909d86" class="outline-4">
<h4 id="org3909d86"><span class="section-number-4">6.2.14.</span> <code>err</code></h4>
<div class="outline-text-4" id="text-6-2-14">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_err</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_err;
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Should any error creation fail here, the</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">function will panic.</span>
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_err(<span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"{} is not a number"</span>),
                <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::t()));
        maj_err(
            <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"This is an error, numbers are {} and {}"</span>),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(2), <span style="color: #4ec9b0;">Maj</span>::integer(3)));
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf9a8bd5" class="outline-4">
<h4 id="orgf9a8bd5"><span class="section-number-4">6.2.15.</span> <span class="todo TODO">TODO</span> <code>warn</code></h4>
<div class="outline-text-4" id="text-6-2-15">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_warn</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8cb0475" class="outline-4">
<h4 id="org8cb0475"><span class="section-number-4">6.2.16.</span> <code>list</code></h4>
<div class="outline-text-4" id="text-6-2-16">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_list</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_list;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_list(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                            <span style="color: #4ec9b0;">Maj</span>::integer(2),
                            <span style="color: #4ec9b0;">Maj</span>::integer(3))),
         <span style="color: #ce9178;">"(1 2 3)"</span>);
        (maj_list(<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
            <span style="color: #4ec9b0;">Maj</span>::integer(6),
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>))),
         <span style="color: #ce9178;">"(a 6 b)"</span>);
        (maj_list(<span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org3dca4d2" class="outline-4">
<h4 id="org3dca4d2"><span class="section-number-4">6.2.17.</span> <code>append</code></h4>
<div class="outline-text-4" id="text-6-2-17">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_append</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_append;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_append(<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                      <span style="color: #4ec9b0;">Maj</span>::integer(2),
                      <span style="color: #4ec9b0;">Maj</span>::integer(3)),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(4),
                      <span style="color: #4ec9b0;">Maj</span>::integer(5),
                      <span style="color: #4ec9b0;">Maj</span>::integer(6)))),
         <span style="color: #ce9178;">"(1 2 3 4 5 6)"</span>);
        (maj_append(<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #c586c0;">maj_list!</span>(
                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                <span style="color: #c586c0;">maj_list!</span>(
                    <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>),
                    <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>)),
                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"d"</span>),
                <span style="color: #c586c0;">maj_list!</span>(
                    <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"e"</span>))),
            <span style="color: #c586c0;">maj_list!</span>(
                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"f"</span>),
                <span style="color: #c586c0;">maj_list!</span>(
                    <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"g"</span>),
                    <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"h"</span>))))),
         <span style="color: #ce9178;">"(a (b c) d (e) f (g h))"</span>);
        (maj_append(<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #c586c0;">maj_list!</span>(
                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>),
                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>)),
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"d"</span>))),
         <span style="color: #ce9178;">"(a b c . d)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c5212e" class="outline-4">
<h4 id="org8c5212e"><span class="section-number-4">6.2.18.</span> <code>last</code></h4>
<div class="outline-text-4" id="text-6-2-18">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_last</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_last;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">b</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">c</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">d</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"d"</span>);
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_last(<span style="color: #c586c0;">maj_list!</span>(a.clone(),
                            b.clone(),
                            c.clone(),
                            d.clone())),
         <span style="color: #ce9178;">"(d)"</span>);
        (maj_last(<span style="color: #c586c0;">maj_dotted_list!</span>(
            a.clone(), b, c, d)),
         <span style="color: #ce9178;">"(c . d)"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_last(a));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org73d8318" class="outline-4">
<h4 id="org73d8318"><span class="section-number-4">6.2.19.</span> <code>reverse</code></h4>
<div class="outline-text-4" id="text-6-2-19">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_reverse</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_reverse;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">b</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">c</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">d</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"d"</span>);
    test_<span style="color: #c586c0;">format!</span>(
        state,
        maj_reverse(<span style="color: #c586c0;">maj_list!</span>(
            a.clone(), b.clone(), c.clone(), d.clone())),
        <span style="color: #ce9178;">"(d c b a)"</span>);
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_reverse(a.clone());
        maj_reverse(<span style="color: #c586c0;">maj_dotted_list!</span>(a, b, c, d));
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb943c26" class="outline-4">
<h4 id="orgb943c26"><span class="section-number-4">6.2.20.</span> <code>nthcdr</code></h4>
<div class="outline-text-4" id="text-6-2-20">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_nthcdr</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_nthcdr;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">list</span> = <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                         <span style="color: #4ec9b0;">Maj</span>::integer(2),
                         <span style="color: #4ec9b0;">Maj</span>::integer(3),
                         <span style="color: #4ec9b0;">Maj</span>::integer(4));
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">dlist</span> = <span style="color: #c586c0;">maj_dotted_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                 <span style="color: #4ec9b0;">Maj</span>::integer(2),
                                 <span style="color: #4ec9b0;">Maj</span>::integer(3),
                                 <span style="color: #4ec9b0;">Maj</span>::integer(4));
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_nthcdr(<span style="color: #4ec9b0;">Maj</span>::integer(0), list.clone()),
         <span style="color: #ce9178;">"(1 2 3 4)"</span>);
        (maj_nthcdr(<span style="color: #4ec9b0;">Maj</span>::integer(1), list.clone()),
         <span style="color: #ce9178;">"(2 3 4)"</span>);
        (maj_nthcdr(<span style="color: #4ec9b0;">Maj</span>::integer(3), list.clone()),
         <span style="color: #ce9178;">"(4)"</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_nthcdr(<span style="color: #4ec9b0;">Maj</span>::integer(3), dlist);
        maj_nthcdr(<span style="color: #4ec9b0;">Maj</span>::integer(-1), list.clone());
        maj_nthcdr(<span style="color: #4ec9b0;">Maj</span>::fraction(3, 4), list.clone());
    );
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_nthcdr(<span style="color: #4ec9b0;">Maj</span>::integer(4), list.clone()),
         <span style="color: #ce9178;">"nil"</span>);
        (maj_nthcdr(<span style="color: #4ec9b0;">Maj</span>::integer(5), list), <span style="color: #ce9178;">"nil"</span>);
        (maj_nthcdr(<span style="color: #4ec9b0;">Maj</span>::integer(50), <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org90737ca" class="outline-4">
<h4 id="org90737ca"><span class="section-number-4">6.2.21.</span> <code>nth</code></h4>
<div class="outline-text-4" id="text-6-2-21">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_nth</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_nth;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">list</span> = <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                         <span style="color: #4ec9b0;">Maj</span>::integer(2),
                         <span style="color: #4ec9b0;">Maj</span>::integer(3),
                         <span style="color: #4ec9b0;">Maj</span>::integer(4));
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">dlist</span> = <span style="color: #c586c0;">maj_dotted_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                 <span style="color: #4ec9b0;">Maj</span>::integer(2),
                                 <span style="color: #4ec9b0;">Maj</span>::integer(3),
                                 <span style="color: #4ec9b0;">Maj</span>::integer(4));
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_nth(<span style="color: #4ec9b0;">Maj</span>::integer(0), list.clone()),
         <span style="color: #ce9178;">"1"</span>);
        (maj_nth(<span style="color: #4ec9b0;">Maj</span>::integer(3), list.clone()),
         <span style="color: #ce9178;">"4"</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_nth(<span style="color: #4ec9b0;">Maj</span>::integer(3), dlist);
        maj_nth(<span style="color: #4ec9b0;">Maj</span>::integer(-1), list.clone());
        maj_nth(<span style="color: #4ec9b0;">Maj</span>::fraction(3, 4), list.clone());
    );
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_nth(<span style="color: #4ec9b0;">Maj</span>::integer(4), list.clone()),
         <span style="color: #ce9178;">"nil"</span>);
        (maj_nth(<span style="color: #4ec9b0;">Maj</span>::integer(5), list), <span style="color: #ce9178;">"nil"</span>);
        (maj_nth(<span style="color: #4ec9b0;">Maj</span>::integer(50), <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org19d668f" class="outline-4">
<h4 id="org19d668f"><span class="section-number-4">6.2.22.</span> <span class="todo TODO">TODO</span> <code>macroexpand-1</code></h4>
<div class="outline-text-4" id="text-6-2-22">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_macroexpand_1</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c165cf" class="outline-4">
<h4 id="org8c165cf"><span class="section-number-4">6.2.23.</span> <span class="todo TODO">TODO</span> <code>macroexpand</code></h4>
<div class="outline-text-4" id="text-6-2-23">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_macroexpand</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8a9ac73" class="outline-4">
<h4 id="org8a9ac73"><span class="section-number-4">6.2.24.</span> <code>not</code></h4>
<div class="outline-text-4" id="text-6-2-24">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_not</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_not;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_not(<span style="color: #4ec9b0;">Maj</span>::integer(1)), <span style="color: #ce9178;">"nil"</span>);
        (maj_not(<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>),
                           <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>),
                           <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"c"</span>))),
         <span style="color: #ce9178;">"nil"</span>);
        (maj_not(<span style="color: #4ec9b0;">Maj</span>::t()), <span style="color: #ce9178;">"nil"</span>);
        (maj_not(<span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"t"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org9c7d944" class="outline-4">
<h4 id="org9c7d944"><span class="section-number-4">6.2.25.</span> <code>gensym</code></h4>
<div class="outline-text-4" id="text-6-2-25">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_gensym</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_gensym;
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Generate a few symbols and that's it.</span>
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">n</span> = 100;
    <span style="color: #569cd6;">for</span> <span style="color: #9cdcfe;">_</span> <span style="color: #569cd6;">in</span> 0..n {
        <span style="color: #c586c0;">test_regex!</span>(state, maj_gensym(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state), <span style="color: #ce9178;">r"^:G[0-9]*$"</span>);
    }
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf8639e8" class="outline-3">
<h3 id="orgf8639e8"><span class="section-number-3">6.3.</span> Funções para vetores</h3>
<div class="outline-text-3" id="text-6-3">
</div>
<div id="outline-container-orgd1444db" class="outline-4">
<h4 id="orgd1444db"><span class="section-number-4">6.3.1.</span> <code>vector</code> e <code>vec-type</code></h4>
<div class="outline-text-4" id="text-6-3-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_vector_vec_type</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_vector,
        maj_vec_type
    };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v1</span> = maj_vector(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil());
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v2</span> = maj_vector(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                              <span style="color: #4ec9b0;">Maj</span>::integer(2),
                                              <span style="color: #4ec9b0;">Maj</span>::integer(3),
                                              <span style="color: #4ec9b0;">Maj</span>::integer(4)));
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v3</span> = maj_vector(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::float(1.0),
                                              <span style="color: #4ec9b0;">Maj</span>::float(3.0),
                                              <span style="color: #4ec9b0;">Maj</span>::float(2.5)));
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v4</span> = maj_vector(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'H'</span>),
                                              <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'e'</span>),
                                              <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'l'</span>),
                                              <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'l'</span>),
                                              <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'o'</span>)));
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">blah</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"blah"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v5</span> = maj_vector(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::float(1.0),
                                              <span style="color: #4ec9b0;">Maj</span>::integer(3),
                                              <span style="color: #4ec9b0;">Maj</span>::fraction(2, 5),
                                              <span style="color: #4ec9b0;">Maj</span>::complex(
                                                  <span style="color: #4ec9b0;">Maj</span>::integer(2),
                                                  <span style="color: #4ec9b0;">Maj</span>::integer(6)),
                                              blah));
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (v1.clone(), <span style="color: #ce9178;">"[]"</span>);
        (maj_vec_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v1), <span style="color: #ce9178;">"any"</span>);
        (v2.clone(), <span style="color: #ce9178;">"[1 2 3 4]"</span>);
        (maj_vec_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v2), <span style="color: #ce9178;">"integer"</span>);
        (v3.clone(), <span style="color: #ce9178;">"[1.0 3.0 2.5]"</span>);
        (maj_vec_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v3), <span style="color: #ce9178;">"float"</span>);
        (v4.clone(), <span style="color: #ce9178;">"\"Hello\""</span>);
        (maj_vec_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v4), <span style="color: #ce9178;">"char"</span>);
        (v5.clone(), <span style="color: #ce9178;">"[1.0 3 2/5 2J6 blah]"</span>);
        (maj_vec_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v5), <span style="color: #ce9178;">"any"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb016e4b" class="outline-4">
<h4 id="orgb016e4b"><span class="section-number-4">6.3.2.</span> <code>vec-coerce</code></h4>
<div class="outline-text-4" id="text-6-3-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitive_vec_coerce</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_vector,
        maj_vec_push,
        maj_vec_type,
        maj_vec_coerce
    };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">integer</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"integer"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">any</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"any"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v</span> = maj_vector(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil());
    test_<span style="color: #c586c0;">format!</span>(state, maj_vec_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v.clone()), <span style="color: #ce9178;">"any"</span>);
    
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">_</span> = maj_vec_push(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(2));
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">_</span> = maj_vec_push(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(3));
    test_<span style="color: #c586c0;">format!</span>(state, maj_vec_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v.clone()), <span style="color: #ce9178;">"any"</span>);
    
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v2</span> = maj_vec_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, integer, v);
    test_<span style="color: #c586c0;">format!</span>(state, maj_vec_type(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, v2), <span style="color: #ce9178;">"integer"</span>);

    test_<span style="color: #c586c0;">format!</span>(state, maj_vec_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, any, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello"</span>)),
                 <span style="color: #ce9178;">"[#\\H #\\e #\\l #\\l #\\o]"</span>);
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org18c5fbf" class="outline-4">
<h4 id="org18c5fbf"><span class="section-number-4">6.3.3.</span> <code>vec-push</code></h4>
<div class="outline-text-4" id="text-6-3-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_vec_push</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_vec_push;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v</span> = <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[]);
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (v.clone(), <span style="color: #ce9178;">"[]"</span>);
        (maj_vec_push(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(5), v.clone()), <span style="color: #ce9178;">"[5]"</span>);
        (maj_vec_push(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(6), v.clone()), <span style="color: #ce9178;">"[5 6]"</span>);
    );

    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #c586c0;">test_fail!</span>(maj_vec_push(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, a.clone(), v.clone()));

    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">myvec</span> = <span style="color: #4ec9b0;">Maj</span>::vector_any(<span style="color: #c586c0;">vec!</span>[]);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">elements</span> = <span style="color: #c586c0;">vec!</span>[
        <span style="color: #4ec9b0;">Maj</span>::integer(5), <span style="color: #4ec9b0;">Maj</span>::integer(6), a,
        <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3)
    ];
    <span style="color: #569cd6;">for</span> <span style="color: #9cdcfe;">elt</span> <span style="color: #569cd6;">in</span> <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span>elements {
        <span style="color: #c586c0;">test_dont_fail!</span>(
            maj_vec_push(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, elt.clone(), myvec.clone()));
    }
    test_<span style="color: #c586c0;">format!</span>(state, myvec, <span style="color: #ce9178;">"[5 6 a 2/3]"</span>);
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb040bbf" class="outline-4">
<h4 id="orgb040bbf"><span class="section-number-4">6.3.4.</span> <code>vec-set</code></h4>
<div class="outline-text-4" id="text-6-3-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_vec_set</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_vec_set;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v</span> = <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3, 4, 5]);
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_vec_set(<span style="color: #4ec9b0;">Maj</span>::integer(2), <span style="color: #4ec9b0;">Maj</span>::integer(50), v.clone()),
         <span style="color: #ce9178;">"[1 2 50 4 5]"</span>);
        (maj_vec_set(<span style="color: #4ec9b0;">Maj</span>::integer(4), <span style="color: #4ec9b0;">Maj</span>::integer(10), v.clone()),
         <span style="color: #ce9178;">"[1 2 50 4 10]"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(
        maj_vec_set(<span style="color: #4ec9b0;">Maj</span>::integer(5), <span style="color: #4ec9b0;">Maj</span>::integer(90), v.clone()));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org7846330" class="outline-4">
<h4 id="org7846330"><span class="section-number-4">6.3.5.</span> <code>vec-pop</code></h4>
<div class="outline-text-4" id="text-6-3-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_vec_pop</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_vec_pop;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v</span> = <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3]);
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (v.clone(), <span style="color: #ce9178;">"[1 2 3]"</span>);
        (maj_vec_pop(v.clone()), <span style="color: #ce9178;">"3"</span>);
        (maj_vec_pop(v.clone()), <span style="color: #ce9178;">"2"</span>);
        (maj_vec_pop(v.clone()), <span style="color: #ce9178;">"1"</span>);
        (maj_vec_pop(v.clone()), <span style="color: #ce9178;">"nil"</span>);
        (v, <span style="color: #ce9178;">"[]"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_vec_pop(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3)));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf146c54" class="outline-4">
<h4 id="orgf146c54"><span class="section-number-4">6.3.6.</span> <code>vec-deq</code></h4>
<div class="outline-text-4" id="text-6-3-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_vec_deq</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_vec_deq;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v</span> = <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[0, 1, 2]);
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (v.clone(), <span style="color: #ce9178;">"[0 1 2]"</span>);
        (maj_vec_deq(v.clone()), <span style="color: #ce9178;">"0"</span>);
        (maj_vec_deq(v.clone()), <span style="color: #ce9178;">"1"</span>);
        (maj_vec_deq(v.clone()), <span style="color: #ce9178;">"2"</span>);
        (maj_vec_deq(v.clone()), <span style="color: #ce9178;">"nil"</span>);
        (v, <span style="color: #ce9178;">"[]"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_vec_deq(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3)));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org057e804" class="outline-4">
<h4 id="org057e804"><span class="section-number-4">6.3.7.</span> <code>vec-length</code></h4>
<div class="outline-text-4" id="text-6-3-7">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_vec_length</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_vec_length,
        maj_iota,
        maj_reverse,
        maj_vector
    };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_vec_length(<span style="color: #4ec9b0;">Maj</span>::vector_any(<span style="color: #c586c0;">vec!</span>[])), <span style="color: #ce9178;">"0"</span>);
        (maj_vec_length(<span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3, 4])), <span style="color: #ce9178;">"4"</span>);
        ({
            <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">iota50</span> = maj_iota(<span style="color: #4ec9b0;">Maj</span>::integer(50));
            <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">reviota</span> = maj_reverse(iota50);
            <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v</span> = maj_vector(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, reviota);
            maj_vec_length(v)
        }, <span style="color: #ce9178;">"50"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_vec_length(state.make_stream_stdin()));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org1504e37" class="outline-4">
<h4 id="org1504e37"><span class="section-number-4">6.3.8.</span> <code>vec-at</code></h4>
<div class="outline-text-4" id="text-6-3-8">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_vec_at</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_vec_at;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_vec_at(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                    <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3])),
         <span style="color: #ce9178;">"2"</span>);
        (maj_vec_at(<span style="color: #4ec9b0;">Maj</span>::integer(0), <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello"</span>)),
         <span style="color: #ce9178;">"#\\H"</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_vec_at(<span style="color: #4ec9b0;">Maj</span>::integer(5), <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello"</span>));
        maj_vec_at(<span style="color: #4ec9b0;">Maj</span>::integer(5),
                   <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                             <span style="color: #4ec9b0;">Maj</span>::integer(2),
                             <span style="color: #4ec9b0;">Maj</span>::integer(3)));
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgefc267e" class="outline-4">
<h4 id="orgefc267e"><span class="section-number-4">6.3.9.</span> <code>vec-remove</code></h4>
<div class="outline-text-4" id="text-6-3-9">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_vec_remove</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_vec_remove;
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">vec</span> = <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3, 4, 5]);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_vec_remove(<span style="color: #4ec9b0;">Maj</span>::integer(2), vec.clone()), <span style="color: #ce9178;">"3"</span>);
        (maj_vec_remove(<span style="color: #4ec9b0;">Maj</span>::integer(2), vec.clone()), <span style="color: #ce9178;">"4"</span>);
        (vec.clone(), <span style="color: #ce9178;">"[1 2 5]"</span>);
        (maj_vec_remove(<span style="color: #4ec9b0;">Maj</span>::integer(2), vec.clone()), <span style="color: #ce9178;">"5"</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_vec_remove(<span style="color: #4ec9b0;">Maj</span>::integer(2), vec);
        maj_vec_remove(<span style="color: #4ec9b0;">Maj</span>::integer(0), <span style="color: #4ec9b0;">Maj</span>::integer(2));
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org34acf49" class="outline-4">
<h4 id="org34acf49"><span class="section-number-4">6.3.10.</span> <code>vec-insert</code></h4>
<div class="outline-text-4" id="text-6-3-10">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_vec_insert</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_vec_insert;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">v</span> = <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3]);
    
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (v.clone(), <span style="color: #ce9178;">"[1 2 3]"</span>);
        (maj_vec_insert(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::integer(5), v.clone()),
         <span style="color: #ce9178;">"[1 2 3 5]"</span>);
        (maj_vec_insert(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(0), <span style="color: #4ec9b0;">Maj</span>::integer(5), v.clone()),
         <span style="color: #ce9178;">"[5 1 2 3 5]"</span>);
        (maj_vec_insert(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(0), <span style="color: #4ec9b0;">Maj</span>::integer(5), v.clone()),
         <span style="color: #ce9178;">"[5 5 1 2 3 5]"</span>);
        (maj_vec_insert(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(0), <span style="color: #4ec9b0;">Maj</span>::integer(5), v.clone()),
         <span style="color: #ce9178;">"[5 5 5 1 2 3 5]"</span>);
        (maj_vec_insert(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(1), <span style="color: #4ec9b0;">Maj</span>::integer(7), v.clone()),
         <span style="color: #ce9178;">"[5 7 5 5 1 2 3 5]"</span>);
        (maj_vec_insert(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::integer(8), v.clone()),
         <span style="color: #ce9178;">"[5 7 5 8 5 1 2 3 5]"</span>);
    );

    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_vec_insert(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                       <span style="color: #4ec9b0;">Maj</span>::integer(20),
                       <span style="color: #4ec9b0;">Maj</span>::integer(8),
                       <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3]));
        maj_vec_insert(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                       <span style="color: #4ec9b0;">Maj</span>::integer(2),
                       a,
                       <span style="color: #4ec9b0;">Maj</span>::vector_integer(<span style="color: #c586c0;">vec!</span>[1, 2, 3]));
    );
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2240fd8" class="outline-3">
<h3 id="org2240fd8"><span class="section-number-3">6.4.</span> Funções numéricas</h3>
<div class="outline-text-3" id="text-6-4">
</div>
<div id="outline-container-org8f3490a" class="outline-4">
<h4 id="org8f3490a"><span class="section-number-4">6.4.1.</span> <code>number-coerce</code></h4>
<div class="outline-text-4" id="text-6-4-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_number_coerce</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_number_coerce;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();

    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">float</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"float"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">integer</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"integer"</span>);

    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_number_coerce(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, float.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(1)), <span style="color: #ce9178;">"1.0"</span>);
        (maj_number_coerce(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, integer.clone(), <span style="color: #4ec9b0;">Maj</span>::complex(
                <span style="color: #4ec9b0;">Maj</span>::integer(1), <span style="color: #4ec9b0;">Maj</span>::integer(3))), <span style="color: #ce9178;">"1"</span>);
        (maj_number_coerce(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, integer.clone(), <span style="color: #4ec9b0;">Maj</span>::float(2.3)), <span style="color: #ce9178;">"2"</span>);
        (maj_number_coerce(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, float, <span style="color: #4ec9b0;">Maj</span>::fraction(2, 5)), <span style="color: #ce9178;">"0.4"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, integer, <span style="color: #4ec9b0;">Maj</span>::t()));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org9efcf49" class="outline-4">
<h4 id="org9efcf49"><span class="section-number-4">6.4.2.</span> <code>real-part</code> e <code>imag-part</code></h4>
<div class="outline-text-4" id="text-6-4-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_real_part_imag_part</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_real_part,
        maj_imag_part
    };
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_real_part(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(5))), <span style="color: #ce9178;">"2"</span>);
        (maj_real_part(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::fraction(3, 2),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(7))), <span style="color: #ce9178;">"3/2"</span>);
        (maj_imag_part(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(5))), <span style="color: #ce9178;">"5"</span>);
        (maj_imag_part(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(7),
                                    <span style="color: #4ec9b0;">Maj</span>::fraction(3, 2))), <span style="color: #ce9178;">"3/2"</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_real_part(<span style="color: #4ec9b0;">Maj</span>::fraction(1, 2));
        maj_real_part(<span style="color: #4ec9b0;">Maj</span>::nil());
        maj_imag_part(<span style="color: #4ec9b0;">Maj</span>::fraction(1, 2));
        maj_imag_part(<span style="color: #4ec9b0;">Maj</span>::nil());
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgca7fd54" class="outline-4">
<h4 id="orgca7fd54"><span class="section-number-4">6.4.3.</span> <code>numer</code> e <code>denom</code></h4>
<div class="outline-text-4" id="text-6-4-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_numer_denom</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_numer,
        maj_denom
    };
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_numer(<span style="color: #4ec9b0;">Maj</span>::fraction(1, 2)), <span style="color: #ce9178;">"1"</span>);
        (maj_numer(<span style="color: #4ec9b0;">Maj</span>::fraction(3, 2)), <span style="color: #ce9178;">"3"</span>);
        (maj_denom(<span style="color: #4ec9b0;">Maj</span>::fraction(1, 2)), <span style="color: #ce9178;">"2"</span>);
        (maj_denom(<span style="color: #4ec9b0;">Maj</span>::fraction(3, 2)), <span style="color: #ce9178;">"2"</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_numer(<span style="color: #4ec9b0;">Maj</span>::integer(2));
        maj_numer(<span style="color: #4ec9b0;">Maj</span>::nil());
        maj_denom(<span style="color: #4ec9b0;">Maj</span>::integer(2));
        maj_denom(<span style="color: #4ec9b0;">Maj</span>::nil());
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d81e0d" class="outline-4">
<h4 id="org7d81e0d"><span class="section-number-4">6.4.4.</span> <code>richest-number-type</code></h4>
<div class="outline-text-4" id="text-6-4-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_richest_number_type</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_richest_number_type;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_richest_number_type(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(2), <span style="color: #4ec9b0;">Maj</span>::float(2.0)),
         <span style="color: #ce9178;">"float"</span>);
        (maj_richest_number_type(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(2), <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3)),
         <span style="color: #ce9178;">"fraction"</span>);
        (maj_richest_number_type(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                                     <span style="color: #4ec9b0;">Maj</span>::integer(3)),
            <span style="color: #4ec9b0;">Maj</span>::integer(9)),
         <span style="color: #ce9178;">"complex"</span>);
        (maj_richest_number_type(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3),
                                     <span style="color: #4ec9b0;">Maj</span>::integer(-9)),
            <span style="color: #4ec9b0;">Maj</span>::float(2.0)),
         <span style="color: #ce9178;">"complex"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_richest_number_type(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3),
                                 <span style="color: #4ec9b0;">Maj</span>::integer(-9)),
        <span style="color: #4ec9b0;">Maj</span>::t()));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb7570c7" class="outline-4">
<h4 id="orgb7570c7"><span class="section-number-4">6.4.5.</span> <code>rich-number-coerce</code></h4>
<div class="outline-text-4" id="text-6-4-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_rich_number_coerce</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_rich_number_coerce;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_rich_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                                <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                                             <span style="color: #4ec9b0;">Maj</span>::integer(3)),
                                <span style="color: #4ec9b0;">Maj</span>::fraction(2, 5)),
         <span style="color: #ce9178;">"(2J3 2/5J0.0)"</span>);
        (maj_rich_number_coerce(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                                <span style="color: #4ec9b0;">Maj</span>::float(1.5),
                                <span style="color: #4ec9b0;">Maj</span>::fraction(5, 2)),
         <span style="color: #ce9178;">"(3/2 5/2)"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_rich_number_coerce(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(2), <span style="color: #4ec9b0;">Maj</span>::t()));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgabdb614" class="outline-4">
<h4 id="orgabdb614"><span class="section-number-4">6.4.6.</span> <code>+</code> (arithmetic plus)</h4>
<div class="outline-text-4" id="text-6-4-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_plus</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_arithm_plus;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_arithm_plus(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"1"</span>);
        (maj_arithm_plus(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                                   <span style="color: #4ec9b0;">Maj</span>::integer(3)))), <span style="color: #ce9178;">"2J-3"</span>);
        (maj_arithm_plus(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                      <span style="color: #4ec9b0;">Maj</span>::integer(2),
                      <span style="color: #4ec9b0;">Maj</span>::integer(3))),
         <span style="color: #ce9178;">"6"</span>);
    );
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #c586c0;">test_fail!</span>(maj_arithm_plus(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #c586c0;">maj_list!</span>(a)));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org3b1811e" class="outline-4">
<h4 id="org3b1811e"><span class="section-number-4">6.4.7.</span> <code>-</code> (arithmetic minus)</h4>
<div class="outline-text-4" id="text-6-4-7">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_minus</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_arithm_minus;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_arithm_minus(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"0"</span>);
        (maj_arithm_minus(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1))), <span style="color: #ce9178;">"-1"</span>);
        (maj_arithm_minus(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                      <span style="color: #4ec9b0;">Maj</span>::integer(2),
                      <span style="color: #4ec9b0;">Maj</span>::integer(3))),
         <span style="color: #ce9178;">"-4"</span>);
    );
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #c586c0;">test_fail!</span>(maj_arithm_minus(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #c586c0;">maj_list!</span>(a)));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd698ba5" class="outline-4">
<h4 id="orgd698ba5"><span class="section-number-4">6.4.8.</span> <code>*</code> (arithmetic times)</h4>
<div class="outline-text-4" id="text-6-4-8">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_times</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_arithm_times;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_arithm_times(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"1"</span>);
        (maj_arithm_times(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(-50))), <span style="color: #ce9178;">"-1"</span>);
        (maj_arithm_times(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                      <span style="color: #4ec9b0;">Maj</span>::integer(2),
                      <span style="color: #4ec9b0;">Maj</span>::integer(3))),
         <span style="color: #ce9178;">"6"</span>);
        (maj_arithm_times(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(3),
                                   <span style="color: #4ec9b0;">Maj</span>::integer(2)),
                      <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                   <span style="color: #4ec9b0;">Maj</span>::integer(7)))),
         <span style="color: #ce9178;">"-11J23.0"</span>);
    );
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #c586c0;">test_fail!</span>(maj_arithm_times(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #c586c0;">maj_list!</span>(a)));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgde11c33" class="outline-4">
<h4 id="orgde11c33"><span class="section-number-4">6.4.9.</span> <code>/</code> (arithmetic divide)</h4>
<div class="outline-text-4" id="text-6-4-9">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_divide</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_arithm_divide;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_arithm_divide(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #ce9178;">"1"</span>);
        (maj_arithm_divide(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(3))), <span style="color: #ce9178;">"1/3"</span>);
        (maj_arithm_divide(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::float(0.5))), <span style="color: #ce9178;">"2"</span>);
        (maj_arithm_divide(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::fraction(1, 2),
                      <span style="color: #4ec9b0;">Maj</span>::complex(
                          <span style="color: #4ec9b0;">Maj</span>::integer(0),
                          <span style="color: #4ec9b0;">Maj</span>::integer(1)))),
         <span style="color: #ce9178;">"0.0J-1/2"</span>);
        (maj_arithm_divide(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::fraction(1, 2))), <span style="color: #ce9178;">"2"</span>);
        (maj_arithm_divide(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(3),
                      <span style="color: #4ec9b0;">Maj</span>::integer(4))),
         <span style="color: #ce9178;">"3/4"</span>);
    );
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_arithm_divide(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                      <span style="color: #4ec9b0;">Maj</span>::integer(3),
                      <span style="color: #4ec9b0;">Maj</span>::integer(0)));
        maj_arithm_divide(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(0)));
        maj_arithm_divide(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(2), a));
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org69f1d55" class="outline-4">
<h4 id="org69f1d55"><span class="section-number-4">6.4.10.</span> <code>iota</code></h4>
<div class="outline-text-4" id="text-6-4-10">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_iota</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_iota;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_iota(<span style="color: #4ec9b0;">Maj</span>::integer(0)), <span style="color: #ce9178;">"nil"</span>);
        (maj_iota(<span style="color: #4ec9b0;">Maj</span>::integer(5)), <span style="color: #ce9178;">"(0 1 2 3 4)"</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_iota(<span style="color: #4ec9b0;">Maj</span>::integer(-1));
        maj_iota(<span style="color: #4ec9b0;">Maj</span>::fraction(2, 3));
        maj_iota(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>));
    );
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3637e7a" class="outline-3">
<h3 id="org3637e7a"><span class="section-number-3">6.5.</span> Funções de comparações</h3>
<div class="outline-text-3" id="text-6-5">
</div>
<div id="outline-container-orga4935b1" class="outline-4">
<h4 id="orga4935b1"><span class="section-number-4">6.5.1.</span> <code>=</code> (numeric equality)</h4>
<div class="outline-text-4" id="text-6-5-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_equal</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_arithm_eq;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::<span style="color: #569cd6;">environment</span>::maj_env_push;
    
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">test_env</span> = maj_env_push(<span style="color: #4ec9b0;">Maj</span>::nil(),
                                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*ulps*"</span>),
                                <span style="color: #4ec9b0;">Maj</span>::integer(3));
    
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_arithm_eq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, test_env.clone(),
                       <span style="color: #4ec9b0;">Maj</span>::fraction(2, 1), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                       <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_arithm_eq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, test_env.clone(),
                       <span style="color: #4ec9b0;">Maj</span>::integer(1), <span style="color: #4ec9b0;">Maj</span>::integer(1),
                       <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_arithm_eq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, test_env.clone(),
                       <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(3)),
                       <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3),
                       <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">false</span>);
        (maj_arithm_eq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, test_env.clone(),
                       <span style="color: #4ec9b0;">Maj</span>::float(2.0), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                       <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_arithm_eq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, test_env.clone(),
                       <span style="color: #4ec9b0;">Maj</span>::integer(2), <span style="color: #4ec9b0;">Maj</span>::fraction(4, 2),
                       <span style="color: #c586c0;">maj_list!</span>(
                           <span style="color: #4ec9b0;">Maj</span>::integer(2),
                           <span style="color: #4ec9b0;">Maj</span>::integer(3),
                           <span style="color: #4ec9b0;">Maj</span>::integer(5))), <span style="color: #569cd6;">false</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_arithm_eq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, test_env,
                             <span style="color: #4ec9b0;">Maj</span>::t(), <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3),
                             <span style="color: #4ec9b0;">Maj</span>::nil()));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org1025b82" class="outline-4">
<h4 id="org1025b82"><span class="section-number-4">6.5.2.</span> <code>float=</code> (floating point equality)</h4>
<div class="outline-text-4" id="text-6-5-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_float_eq</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_arithm_floateq,
        maj_arithm_times,
        maj_arithm_plus
    };
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::<span style="color: #569cd6;">environment</span>::maj_env_push;
    
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">test_env</span> = maj_env_push(<span style="color: #4ec9b0;">Maj</span>::nil(),
                                <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*ulps*"</span>),
                                <span style="color: #4ec9b0;">Maj</span>::integer(3));

    
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">f</span> = <span style="color: #4ec9b0;">Maj</span>::float(0.1);
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">sum</span> = <span style="color: #4ec9b0;">Maj</span>::float(0.0);

    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(repeat 10 (set sum (+ sum f)))</span>
    <span style="color: #569cd6;">for</span> <span style="color: #9cdcfe;">_</span> <span style="color: #569cd6;">in</span> 0..10 {
        sum = maj_arithm_plus(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, test_env.clone(),
                              <span style="color: #c586c0;">maj_list!</span>(sum.clone(), f.clone()));
    }

    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(def product (* f 10))</span>
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">product</span> =
        maj_arithm_times(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, test_env.clone(),
                         <span style="color: #c586c0;">maj_list!</span>(f.clone(), <span style="color: #4ec9b0;">Maj</span>::float(10.0)));
    
    <span style="color: #c586c0;">test_boolean!</span>(maj_arithm_floateq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, test_env.clone(),
                                     sum, product),
                  <span style="color: #569cd6;">true</span>);
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgefd1226" class="outline-4">
<h4 id="orgefd1226"><span class="section-number-4">6.5.3.</span> <code>&gt;</code> (greater than)</h4>
<div class="outline-text-4" id="text-6-5-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_greater</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_arithm_greater;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();

    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">one</span> = <span style="color: #4ec9b0;">Maj</span>::integer(1);
    
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_arithm_greater(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                            <span style="color: #4ec9b0;">Maj</span>::fraction(5, 2), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                            <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_arithm_greater(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                            <span style="color: #4ec9b0;">Maj</span>::integer(1), one, <span style="color: #4ec9b0;">Maj</span>::nil()),
         <span style="color: #569cd6;">false</span>);
        (maj_arithm_greater(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                            <span style="color: #4ec9b0;">Maj</span>::integer(10), <span style="color: #4ec9b0;">Maj</span>::integer(5),
                            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::integer(1))),
         <span style="color: #569cd6;">true</span>);
        (maj_arithm_greater(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                            <span style="color: #4ec9b0;">Maj</span>::integer(1), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(3))), <span style="color: #569cd6;">false</span>);
    );

    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_arithm_greater(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                                                    <span style="color: #4ec9b0;">Maj</span>::integer(3)),
                           <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3), <span style="color: #4ec9b0;">Maj</span>::nil());
        maj_arithm_greater(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::t(),
                           <span style="color: #4ec9b0;">Maj</span>::nil());
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8607c3b" class="outline-4">
<h4 id="org8607c3b"><span class="section-number-4">6.5.4.</span> <code>&lt;</code> (lesser than)</h4>
<div class="outline-text-4" id="text-6-5-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_lesser</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_arithm_lesser;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();

    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">one</span> = <span style="color: #4ec9b0;">Maj</span>::integer(1);
    
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_arithm_lesser(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                           <span style="color: #4ec9b0;">Maj</span>::integer(2), <span style="color: #4ec9b0;">Maj</span>::fraction(5, 2),
                           <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_arithm_lesser(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                            <span style="color: #4ec9b0;">Maj</span>::integer(1), one, <span style="color: #4ec9b0;">Maj</span>::nil()),
         <span style="color: #569cd6;">false</span>);
        (maj_arithm_lesser(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                           <span style="color: #4ec9b0;">Maj</span>::integer(1), <span style="color: #4ec9b0;">Maj</span>::integer(3),
                           <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(5),
                                     <span style="color: #4ec9b0;">Maj</span>::integer(10))),
         <span style="color: #569cd6;">true</span>);
        (maj_arithm_lesser(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
                           <span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                           <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1))), <span style="color: #569cd6;">false</span>);
    );

    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_arithm_lesser(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(2),
                                                   <span style="color: #4ec9b0;">Maj</span>::integer(3)),
                          <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3), <span style="color: #4ec9b0;">Maj</span>::nil());
        maj_arithm_lesser(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::t(),
                          <span style="color: #4ec9b0;">Maj</span>::nil());
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org61d3cd9" class="outline-4">
<h4 id="org61d3cd9"><span class="section-number-4">6.5.5.</span> <code>&gt;=</code> (greater or equal)</h4>
<div class="outline-text-4" id="text-6-5-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_geq</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_arithm_geq;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::<span style="color: #569cd6;">environment</span>::maj_env_push;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">env</span> = maj_env_push(<span style="color: #4ec9b0;">Maj</span>::nil(),
                           <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*ulps*"</span>),
                           <span style="color: #4ec9b0;">Maj</span>::integer(3));
    
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_arithm_geq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                        <span style="color: #4ec9b0;">Maj</span>::fraction(5, 2), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                        <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_arithm_geq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                        <span style="color: #4ec9b0;">Maj</span>::float(2.0), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                        <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_arithm_geq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                        <span style="color: #4ec9b0;">Maj</span>::integer(1), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(3))), <span style="color: #569cd6;">false</span>);
        (maj_arithm_geq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                        <span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::integer(3),
                        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1))), <span style="color: #569cd6;">true</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_arithm_geq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                       <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(5),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(9)),
                       <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(6),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(9)),
                       <span style="color: #4ec9b0;">Maj</span>::nil());
        maj_arithm_geq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env,
                       <span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::t(), <span style="color: #4ec9b0;">Maj</span>::nil());
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org1870ac8" class="outline-4">
<h4 id="org1870ac8"><span class="section-number-4">6.5.6.</span> <code>&lt;=</code> (lesser or equal)</h4>
<div class="outline-text-4" id="text-6-5-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_arithm_leq</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_arithm_leq;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::<span style="color: #569cd6;">environment</span>::maj_env_push;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">env</span> = maj_env_push(<span style="color: #4ec9b0;">Maj</span>::nil(),
                           <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*ulps*"</span>),
                           <span style="color: #4ec9b0;">Maj</span>::integer(3));
    
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_arithm_leq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                        <span style="color: #4ec9b0;">Maj</span>::fraction(5, 2), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                        <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">false</span>);
        (maj_arithm_leq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                        <span style="color: #4ec9b0;">Maj</span>::float(2.0), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                        <span style="color: #4ec9b0;">Maj</span>::nil()), <span style="color: #569cd6;">true</span>);
        (maj_arithm_leq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                        <span style="color: #4ec9b0;">Maj</span>::integer(1), <span style="color: #4ec9b0;">Maj</span>::integer(2),
                        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(3))), <span style="color: #569cd6;">true</span>);
        (maj_arithm_leq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                        <span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::integer(3),
                        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::integer(1))), <span style="color: #569cd6;">false</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_arithm_leq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env.clone(),
                       <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(5),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(9)),
                       <span style="color: #4ec9b0;">Maj</span>::complex(<span style="color: #4ec9b0;">Maj</span>::integer(6),
                                    <span style="color: #4ec9b0;">Maj</span>::integer(9)),
                       <span style="color: #4ec9b0;">Maj</span>::nil());
        maj_arithm_leq(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, env,
                       <span style="color: #4ec9b0;">Maj</span>::integer(3), <span style="color: #4ec9b0;">Maj</span>::t(), <span style="color: #4ec9b0;">Maj</span>::nil());
    );
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org55e779e" class="outline-3">
<h3 id="org55e779e"><span class="section-number-3">6.6.</span> Funções de streams</h3>
<div class="outline-text-3" id="text-6-6">
</div>
<div id="outline-container-orgdc772ea" class="outline-4">
<h4 id="orgdc772ea"><span class="section-number-4">6.6.1.</span> <code>open-stream</code> e <code>close-stream</code></h4>
<div class="outline-text-4" id="text-6-6-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_open_stream_close_stream</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_open_stream,
        maj_close_stream
    };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">out_sym</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"out"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">outstream</span>;
    
    <span style="color: #c586c0;">multi_regex_test!</span>(
        state;
        ({
            outstream =
                maj_open_stream(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, out_sym.clone(),
                                <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"test-streams-out.txt"</span>));
            outstream.clone()
        }, <span style="color: #4ec9b0;">RE_OUT_STREAM</span>);
    );
    <span style="color: #c586c0;">multi_boolean_test!</span>(
        (maj_close_stream(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, outstream.clone()), <span style="color: #569cd6;">true</span>);
        (maj_close_stream(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, outstream.clone()), <span style="color: #569cd6;">false</span>);
    );
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_open_stream(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, out_sym.clone(), <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"/"</span>));
        maj_close_stream(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, out_sym.clone());
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org1d5eac8" class="outline-4">
<h4 id="org1d5eac8"><span class="section-number-4">6.6.2.</span> <code>stat</code></h4>
<div class="outline-text-4" id="text-6-6-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_stat</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_stat,
        maj_open_stream,
        maj_close_stream
    };
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">outsym</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"out"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">outstream</span> =
        maj_open_stream(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, outsym,
                        <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"test-streams-out.txt"</span>));

    <span style="color: #569cd6;">if</span> maj_errorp(outstream.clone()).to_bool() {
        <span style="color: #c586c0;">panic!</span>(<span style="color: #ce9178;">"Cannot open output stream"</span>);
    }
    
    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_stat(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, outstream.clone()), <span style="color: #ce9178;">"open"</span>);
        ({
            maj_close_stream(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, outstream.clone());
            maj_stat(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, outstream)
        }, <span style="color: #ce9178;">"closed"</span>);
    );
    <span style="color: #c586c0;">test_fail!</span>(maj_stat(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(3)));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org4617032" class="outline-4">
<h4 id="org4617032"><span class="section-number-4">6.6.3.</span> <code>write</code></h4>
<div class="outline-text-4" id="text-6-6-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_write</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::maj_write;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">outstream</span> = state.make_stream_stdout();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">instream</span>  = state.make_stream_stdin();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">closure</span> =
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(lit closure nil (x) ((* x x)))</span>
        <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::lit(), <span style="color: #4ec9b0;">Maj</span>::closure(), <span style="color: #4ec9b0;">Maj</span>::nil(),
                  <span style="color: #c586c0;">maj_list!</span>(x.clone()),
                  <span style="color: #c586c0;">maj_list!</span>(
                      <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*"</span>),
                                x.clone(), x)));
    <span style="color: #c586c0;">test_boolean!</span>(maj_write(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, closure.clone(), outstream),
                  <span style="color: #569cd6;">false</span>);
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_write(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, closure.clone(), instream);
        maj_write(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, closure.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(5));
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orga692a23" class="outline-4">
<h4 id="orga692a23"><span class="section-number-4">6.6.4.</span> <span class="todo TODO">TODO</span> <code>read</code></h4>
<div class="outline-text-4" id="text-6-6-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_read</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org36ececc" class="outline-4">
<h4 id="org36ececc"><span class="section-number-4">6.6.5.</span> <code>read-char</code> e <code>peek-char</code></h4>
<div class="outline-text-4" id="text-6-6-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_read_char_peek_char</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::<span style="color: #569cd6;">types</span>::<span style="color: #4ec9b0;">MajStreamDirection</span>;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_peek_char,
        maj_read_char,
        maj_close_stream
    };
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">predicates</span>::maj_eq;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">eof</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"eof"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">istream</span> = <span style="color: #4ec9b0;">Maj</span>::stream(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
        <span style="color: #ce9178;">"test-streams-in.txt"</span>,
        <span style="color: #4ec9b0;">MajStreamDirection</span>::<span style="color: #4ec9b0;">In</span>).unwrap();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">stdout</span> = state.make_stream_stdout();

    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_peek_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone()), <span style="color: #ce9178;">"#\\H"</span>);
        (maj_peek_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone()), <span style="color: #ce9178;">"#\\H"</span>);
        (maj_read_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone()), <span style="color: #ce9178;">"#\\H"</span>);
        (maj_read_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone()), <span style="color: #ce9178;">"#\\e"</span>);
        ({
            <span style="color: #569cd6;">while</span> !maj_eq(maj_read_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone()),
                          eof.clone()).to_bool() {}
            maj_peek_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone())
        }, <span style="color: #ce9178;">"eof"</span>);
        (maj_read_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone()), <span style="color: #ce9178;">"eof"</span>);
    );

    <span style="color: #c586c0;">test_boolean!</span>(maj_close_stream(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone()),
                  <span style="color: #569cd6;">true</span>);
    
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_read_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, stdout.clone());
        maj_peek_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, stdout);
        maj_read_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone());
        maj_peek_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, istream.clone());
        maj_read_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3));
        maj_peek_char(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::fraction(2, 3));
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org00bc325" class="outline-4">
<h4 id="org00bc325"><span class="section-number-4">6.6.6.</span> <code>write-char</code> e <code>write-string</code></h4>
<div class="outline-text-4" id="text-6-6-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">primitives_write_char_write_string</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">primitives</span>::{
        maj_write_char,
        maj_write_string,
        maj_close_stream
    };
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">core</span>::<span style="color: #569cd6;">types</span>::<span style="color: #4ec9b0;">MajStreamDirection</span>;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">ostream</span> = <span style="color: #4ec9b0;">Maj</span>::stream(
        <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state,
        <span style="color: #ce9178;">"test-streams-out.txt"</span>,
        <span style="color: #4ec9b0;">MajStreamDirection</span>::<span style="color: #4ec9b0;">Out</span>).unwrap();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">stdin</span>  = state.make_stream_stdin();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">stdout</span> = state.make_stream_stdout();

    <span style="color: #c586c0;">multi_test!</span>(
        state;
        (maj_write_char(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'a'</span>), ostream.clone()),
         <span style="color: #ce9178;">"nil"</span>);
        (maj_write_string(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello"</span>), ostream.clone()),
         <span style="color: #ce9178;">"nil"</span>);
    );

    <span style="color: #c586c0;">test_boolean!</span>(
        maj_close_stream(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, ostream.clone()), <span style="color: #569cd6;">true</span>);
    
    <span style="color: #c586c0;">multi_fail_test!</span>(
        maj_write_char(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'a'</span>), ostream.clone());
        maj_write_string(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello"</span>), ostream.clone());
        maj_write_char(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'a'</span>), stdin.clone());
        maj_write_string(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello"</span>), stdin.clone());
        maj_write_char(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::character(<span style="color: #ce9178;">'a'</span>), <span style="color: #4ec9b0;">Maj</span>::integer(5));
        maj_write_string(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::string(<span style="color: #ce9178;">"Hello"</span>), <span style="color: #4ec9b0;">Maj</span>::integer(5));
        maj_write_char(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(5), stdout.clone());
        maj_write_string(
            <span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #4ec9b0;">Maj</span>::integer(5), stdout.clone());
    );
}
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org0da2871" class="outline-2">
<h2 id="org0da2871"><span class="section-number-2">7.</span> Ligações e Contextos</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org835f913" class="outline-3">
<h3 id="org835f913"><span class="section-number-3">7.1.</span> Ligações globais</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">environments_global_bindings</span>() {
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">use crate::axioms::MajRawSym;</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">use crate::axioms::utils::sym_from_raw;</span>
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">my_value</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"my-value"</span>);

    <span style="color: #c586c0;">multi_eval_ast_test!</span>(
        state;
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(def my-value 5)</span>
        (<span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"def"</span>),
                   my_value.clone(),
                   <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"my-value"</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">my-value</span>
        (my_value.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"5"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org9a6c737" class="outline-3">
<h3 id="org9a6c737"><span class="section-number-3">7.2.</span> Ligações léxicas/estáticas</h3>
<div class="outline-text-3" id="text-7-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">environments_lexical_bindings</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #4ec9b0;">MajRawSym</span>;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">utils</span>::sym_from_raw;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">f</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"f"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">def</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"def"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">g</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"g"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">y</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"y"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">plussym</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"+"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fnsym</span> = sym_from_raw(<span style="color: #4ec9b0;">MajRawSym</span>::<span style="color: #4ec9b0;">Fn</span>);
    <span style="color: #c586c0;">multi_eval_ast_test!</span>(
        state;
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(def f (fn (x) (+ x 1)))</span>
        (<span style="color: #c586c0;">maj_list!</span>(def.clone(), f.clone(),
                   <span style="color: #c586c0;">maj_list!</span>(fnsym.clone(),
                             <span style="color: #c586c0;">maj_list!</span>(x.clone()),
                             <span style="color: #c586c0;">maj_list!</span>(
                                 plussym.clone(),
                                 x.clone(),
                                 <span style="color: #4ec9b0;">Maj</span>::integer(1)))),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"f"</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(f 5)</span>
        (<span style="color: #c586c0;">maj_list!</span>(f.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"6"</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(def g ((fn (x) (fn (y) (+ x y))) 9))</span>
        (<span style="color: #c586c0;">maj_list!</span>(def.clone(), g.clone(),
                   <span style="color: #c586c0;">maj_list!</span>(
                       <span style="color: #c586c0;">maj_list!</span>(fnsym.clone(),
                                 <span style="color: #c586c0;">maj_list!</span>(x.clone()),
                                 <span style="color: #c586c0;">maj_list!</span>(fnsym.clone(),
                                           <span style="color: #c586c0;">maj_list!</span>(y.clone()),
                                           <span style="color: #c586c0;">maj_list!</span>(
                                               plussym.clone(),
                                               x.clone(),
                                               y.clone()))),
                       <span style="color: #4ec9b0;">Maj</span>::integer(9))),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"g"</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(g 4)</span>
        (<span style="color: #c586c0;">maj_list!</span>(g.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(4)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"13"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org5758c89" class="outline-3">
<h3 id="org5758c89"><span class="section-number-3">7.3.</span> Ligações dinâmicas</h3>
<div class="outline-text-3" id="text-7-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">environments_dynamic_bindings</span>() {
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #4ec9b0;">MajRawSym</span>;
    <span style="color: #569cd6;">use</span> <span style="color: #569cd6;">crate</span>::<span style="color: #569cd6;">axioms</span>::<span style="color: #569cd6;">utils</span>::sym_from_raw;
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">my_function</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"my-function"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">def</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"def"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">my_value</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"*my-value*"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">fnsym</span> = sym_from_raw(<span style="color: #4ec9b0;">MajRawSym</span>::<span style="color: #4ec9b0;">Fn</span>);
    
    <span style="color: #c586c0;">multi_eval_ast_test!</span>(
        state;
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(def *my-value* 5)</span>
        (<span style="color: #c586c0;">maj_list!</span>(def.clone(), my_value.clone(),
                   <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"*my-value*"</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">*my-value*</span>
        (my_value.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"5"</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(def my-function (fn () *my-value*))</span>
        (<span style="color: #c586c0;">maj_list!</span>(def.clone(), my_function.clone(),
                   <span style="color: #c586c0;">maj_list!</span>(
                       fnsym.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(),
                       my_value.clone())),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"my-function"</span>);
        (<span style="color: #c586c0;">maj_list!</span>(my_function.clone()),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"5"</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">((fn (*my-value*) (my-function)) 6)</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #c586c0;">maj_list!</span>(fnsym.clone(),
                      <span style="color: #c586c0;">maj_list!</span>(my_value.clone()),
                      <span style="color: #c586c0;">maj_list!</span>(my_function.clone())),
            <span style="color: #4ec9b0;">Maj</span>::integer(6)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"6"</span>);
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(let ((*my-value* 7))</span>
        <span style="color: #6a9955;">//   </span><span style="color: #6a9955;">(my-function))</span>
        (<span style="color: #c586c0;">maj_list!</span>(my_function.clone()),
         <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::cons(my_value.clone(),
                             <span style="color: #4ec9b0;">Maj</span>::integer(7))),
         <span style="color: #ce9178;">"7"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org1bbc8ba" class="outline-3">
<h3 id="org1bbc8ba"><span class="section-number-3">7.4.</span> Mutabilidade</h3>
<div class="outline-text-3" id="text-7-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">environment_mutability_set</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">def</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"def"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">set</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"set"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span>   = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">mutate_x</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"mutate-x"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">mutate_x_local</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"mutate-x-local"</span>);
    <span style="color: #c586c0;">multi_eval_ast_test!</span>(
        state;
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(def x 5)</span>
        (<span style="color: #c586c0;">maj_list!</span>(def.clone(), x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"x"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"5"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(set x 9)</span>
        (<span style="color: #c586c0;">maj_list!</span>(set.clone(), x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(9)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"x"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"9"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(do (set x (1+ x)) x)</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">context: ((x . 12))</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::do_sym(),
            <span style="color: #c586c0;">maj_list!</span>(
                set.clone(), x.clone(),
                <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"1+"</span>),
                          x.clone())),
            x.clone()),
         <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::cons(x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(12))),
         <span style="color: #ce9178;">"13"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(defn mutate-x () (set x (+ x 2)) x)</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"defn"</span>),
            mutate_x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(
                set.clone(), x.clone(),
                <span style="color: #c586c0;">maj_list!</span>(
                    <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"+"</span>),
                    x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(2))),
            x.clone()),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"mutate-x"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(mutate-x) altering x globally</span>
        (<span style="color: #c586c0;">maj_list!</span>(mutate_x.clone()), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"11"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(mutate-x) altering x dynamically</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">context: ((x . 12))</span>
        (<span style="color: #c586c0;">maj_list!</span>(mutate_x.clone()),
         <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::cons(x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(12))),
         <span style="color: #ce9178;">"14"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x, unchanged</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"11"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(defn mutate-x-local () (set x (+ x 2)) x)</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">context: ((x . 12))</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"defn"</span>),
            mutate_x_local.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(),
            <span style="color: #c586c0;">maj_list!</span>(
                set.clone(), x.clone(),
                <span style="color: #c586c0;">maj_list!</span>(
                    <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"+"</span>),
                    x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(2))),
            x.clone()),
         <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::cons(x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(12))),
         <span style="color: #ce9178;">"mutate-x-local"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(mutate-x-local) changing captured environment</span>
        (<span style="color: #c586c0;">maj_list!</span>(mutate_x_local.clone()), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"14"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x, unchanged</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"11"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(mutate-x-local) changing captured environment</span>
        (<span style="color: #c586c0;">maj_list!</span>(mutate_x_local.clone()), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"16"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x, unchanged</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"11"</span>);
    );
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">environment_mutability_set_car_set_cdr</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">def</span>     = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"def"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">defn</span>    = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"defn"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">set_car</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"set-car"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">set_cdr</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"set-cdr"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">x</span>       = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"x"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">a</span>       = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"a"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">b</span>       = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"b"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">replace_x_elts</span> = <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"replace-x-elts"</span>);
    <span style="color: #569cd6;">let</span> <span style="color: #9cdcfe;">replace_x_elts_local</span> =
        <span style="color: #4ec9b0;">Maj</span>::symbol(<span style="color: #d4d4d4; background-color: #1e1e1e;">&amp;</span><span style="color: #569cd6;">mut</span> state, <span style="color: #ce9178;">"replace-x-elts-local"</span>);
    <span style="color: #c586c0;">multi_eval_ast_test!</span>(
        state;
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(def x '(1 . 2))</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            def.clone(), x.clone(),
            <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::quote(), <span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::integer(1),
                                              <span style="color: #4ec9b0;">Maj</span>::integer(2)))),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"x"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"(1 . 2)"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(set-car x 5)</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            set_car.clone(), x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(5)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"(5 . 2)"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(set-cdr x 6)</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            set_cdr.clone(), x.clone(), <span style="color: #4ec9b0;">Maj</span>::integer(6)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"(5 . 6)"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"(5 . 6)"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">defining replace-x-elts</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            defn.clone(), replace_x_elts.clone(),
            <span style="color: #c586c0;">maj_list!</span>(a.clone(), b.clone()),
            <span style="color: #c586c0;">maj_list!</span>(set_car.clone(), x.clone(), a.clone()),
            <span style="color: #c586c0;">maj_list!</span>(set_cdr.clone(), x.clone(), b.clone()),
            x.clone()),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"replace-x-elts"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(replace-x-elts 20 90)</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">context: ((x . (9 . 10)))</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            replace_x_elts.clone(),
            <span style="color: #4ec9b0;">Maj</span>::integer(20), <span style="color: #4ec9b0;">Maj</span>::integer(90)),
         <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::cons(x.clone(),
                             <span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::integer(9),
                                       <span style="color: #4ec9b0;">Maj</span>::integer(10)))),
         <span style="color: #ce9178;">"(20 . 90)"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"(5 . 6)"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(replace-x-elts 30 45)</span>
        (<span style="color: #c586c0;">maj_list!</span>(replace_x_elts.clone(),
                   <span style="color: #4ec9b0;">Maj</span>::integer(30), <span style="color: #4ec9b0;">Maj</span>::integer(45)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"(30 . 45)"</span>);
        
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"(30 . 45)"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">defining replace-x-elts-local</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">context: ((x . (9 . 10)))</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            defn.clone(), replace_x_elts_local.clone(),
            <span style="color: #c586c0;">maj_list!</span>(a.clone(), b.clone()),
            <span style="color: #c586c0;">maj_list!</span>(set_car.clone(), x.clone(), a.clone()),
            <span style="color: #c586c0;">maj_list!</span>(set_cdr.clone(), x.clone(), b.clone()),
            x.clone()),
         <span style="color: #c586c0;">maj_list!</span>(<span style="color: #4ec9b0;">Maj</span>::cons(x.clone(),
                             <span style="color: #4ec9b0;">Maj</span>::cons(<span style="color: #4ec9b0;">Maj</span>::integer(9),
                                       <span style="color: #4ec9b0;">Maj</span>::integer(10)))),
         <span style="color: #ce9178;">"replace-x-elts-local"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">(replace-x-elts-local 13 50)</span>
        (<span style="color: #c586c0;">maj_list!</span>(
            replace_x_elts_local.clone(),
            <span style="color: #4ec9b0;">Maj</span>::integer(13), <span style="color: #4ec9b0;">Maj</span>::integer(50)),
         <span style="color: #4ec9b0;">Maj</span>::nil(),
         <span style="color: #ce9178;">"(13 . 50)"</span>);

        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">x</span>
        (x.clone(), <span style="color: #4ec9b0;">Maj</span>::nil(), <span style="color: #ce9178;">"(30 . 45)"</span>);
    );
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga2ca306" class="outline-2">
<h2 id="orga2ca306"><span class="section-number-2">8.</span> Leitor (Tokenizador e Parser)</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org8846b12" class="outline-3">
<h3 id="org8846b12"><span class="section-number-3">8.1.</span> Expressões simples</h3>
<div class="outline-text-3" id="text-8-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">reader_simple_expressions</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_parser_test!</span>(
        state;
        (<span style="color: #ce9178;">""</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"test"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"test"</span>], <span style="color: #ce9178;">"(test)"</span>);
        (<span style="color: #ce9178;">"(defn foo ()</span>
<span style="color: #ce9178;">            (print \"Hello world\"))"</span>,
         <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"defn"</span>, <span style="color: #ce9178;">"foo"</span>, <span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">")"</span>,
              <span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"print"</span>, <span style="color: #ce9178;">"\"Hello world\""</span>, <span style="color: #ce9178;">")"</span>, <span style="color: #ce9178;">")"</span>],
         <span style="color: #ce9178;">"((defn foo nil (print \"Hello world\")))"</span>);
        (<span style="color: #ce9178;">"foo (foo) 5"</span>,
         <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"foo"</span>, <span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"foo"</span>, <span style="color: #ce9178;">")"</span>, <span style="color: #ce9178;">"5"</span>],
         <span style="color: #ce9178;">"(foo (foo) 5)"</span>);
    );
    <span style="color: #c586c0;">multi_parser_fail_test!</span>(
        state;
        <span style="color: #ce9178;">"(')"</span>;
        <span style="color: #ce9178;">"(a . b c)"</span>;
        <span style="color: #ce9178;">"(a ."</span>;
        <span style="color: #ce9178;">"(a . "</span>;
        <span style="color: #ce9178;">"(a . b"</span>;
        <span style="color: #ce9178;">"a b . c d e"</span>;
        <span style="color: #ce9178;">"foo bar '"</span>;
        <span style="color: #ce9178;">"foo bar ,"</span>;
        <span style="color: #ce9178;">"foo bar ,@"</span>;
        <span style="color: #ce9178;">"foo ',@"</span>;
        <span style="color: #ce9178;">"#\\invalidchar"</span>;
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfee225f" class="outline-3">
<h3 id="orgfee225f"><span class="section-number-3">8.2.</span> Números</h3>
<div class="outline-text-3" id="text-8-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">reader_numbers</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_parser_fail_test!</span>(
        state;
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">These are supposed to be parser errors!</span>
        <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Fix the parser so that these produce proper errors.</span>
        <span style="color: #ce9178;">"J"</span>;
        <span style="color: #ce9178;">"j"</span>;
        <span style="color: #ce9178;">"."</span>;
        <span style="color: #ce9178;">"/"</span>;
        <span style="color: #ce9178;">"1/0"</span>;
        <span style="color: #ce9178;">"1/00"</span>;
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org68ea48f" class="outline-3">
<h3 id="org68ea48f"><span class="section-number-3">8.3.</span> Strings</h3>
<div class="outline-text-3" id="text-8-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">reader_strings</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_parser_test!</span>(
        state;
        (<span style="color: #ce9178;">"\"Hello\\nworld\""</span>,
         <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"\"Hello\\nworld\""</span>],
         <span style="color: #ce9178;">"(\"Hello\nworld\")"</span>);
        (<span style="color: #ce9178;">"\"Hello\\tworld\""</span>,
        <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"\"Hello\\tworld\""</span>],
        <span style="color: #ce9178;">"(\"Hello       world\")"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org5c031aa" class="outline-3">
<h3 id="org5c031aa"><span class="section-number-3">8.4.</span> Read macros</h3>
<div class="outline-text-3" id="text-8-4">
</div>
<div id="outline-container-orge4d7359" class="outline-4">
<h4 id="orge4d7359"><span class="section-number-4">8.4.1.</span> Comentários</h4>
<div class="outline-text-4" id="text-8-4-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">reader_comments</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_parser_test!</span>(
        state;
        (<span style="color: #ce9178;">";"</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"; "</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">";;"</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">";; "</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">";;;"</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">";;; "</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"; Coment&#225;rio"</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">";; Coment&#225;rio"</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">";;; Coment&#225;rio"</span>, <span style="color: #c586c0;">vec!</span>[], <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">";; Coment&#225;rios seguidos</span>
<span style="color: #ce9178;">          ;; Em v&#225;rias linhas"</span>,
         <span style="color: #c586c0;">vec!</span>[],
         <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">";; Coment&#225;rio com tokens</span>
<span style="color: #ce9178;">          (+ 1 2)"</span>,
         <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"+"</span>, <span style="color: #ce9178;">"1"</span>, <span style="color: #ce9178;">"2"</span>, <span style="color: #ce9178;">")"</span>],
         <span style="color: #ce9178;">"((+ 1 2))"</span>);
        (<span style="color: #ce9178;">"(+ 1 2) ; Coment&#225;rio ao final"</span>,
         <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"+"</span>, <span style="color: #ce9178;">"1"</span>, <span style="color: #ce9178;">"2"</span>, <span style="color: #ce9178;">")"</span>],
        <span style="color: #ce9178;">"((+ 1 2))"</span>);
        (<span style="color: #ce9178;">"(+ 1 2) ; Coment&#225;rio ao final e continua</span>
<span style="color: #ce9178;">          (- 3 4)"</span>,
         <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"+"</span>, <span style="color: #ce9178;">"1"</span>, <span style="color: #ce9178;">"2"</span>, <span style="color: #ce9178;">")"</span>,
              <span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"-"</span>, <span style="color: #ce9178;">"3"</span>, <span style="color: #ce9178;">"4"</span>, <span style="color: #ce9178;">")"</span>],
        <span style="color: #ce9178;">"((+ 1 2) (- 3 4))"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb4dc385" class="outline-4">
<h4 id="orgb4dc385"><span class="section-number-4">8.4.2.</span> Quote</h4>
<div class="outline-text-4" id="text-8-4-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">reader_quote</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_parser_test!</span>(
        state;
        (<span style="color: #ce9178;">"'foo"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"'"</span>, <span style="color: #ce9178;">"foo"</span>], <span style="color: #ce9178;">"((quote foo))"</span>);
        (<span style="color: #ce9178;">"'a 'b 'c"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"'"</span>, <span style="color: #ce9178;">"a"</span>, <span style="color: #ce9178;">"'"</span>, <span style="color: #ce9178;">"b"</span>, <span style="color: #ce9178;">"'"</span>, <span style="color: #ce9178;">"c"</span>],
         <span style="color: #ce9178;">"((quote a) (quote b) (quote c))"</span>);
        (<span style="color: #ce9178;">"'a"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"'"</span>, <span style="color: #ce9178;">"a"</span>], <span style="color: #ce9178;">"((quote a))"</span>);
        (<span style="color: #ce9178;">"'(1 2 3)"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"'"</span>, <span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"1"</span>, <span style="color: #ce9178;">"2"</span>, <span style="color: #ce9178;">"3"</span>, <span style="color: #ce9178;">")"</span>],
         <span style="color: #ce9178;">"((quote (1 2 3)))"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd9edc17" class="outline-4">
<h4 id="orgd9edc17"><span class="section-number-4">8.4.3.</span> Quasiquote, Unquote, Unquote-Splice</h4>
<div class="outline-text-4" id="text-8-4-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">reader_quasiquote_unquote_unquotesplice</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_parser_test!</span>(
        state;
        (<span style="color: #ce9178;">"`(x)"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"`"</span>, <span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">")"</span>],
         <span style="color: #ce9178;">"((quasiquote (x)))"</span>);
        (<span style="color: #ce9178;">"`(+ ,x ,y)"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"`"</span>, <span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"+"</span>, <span style="color: #ce9178;">","</span>, <span style="color: #ce9178;">"x"</span>,
                            <span style="color: #ce9178;">","</span>, <span style="color: #ce9178;">"y"</span>, <span style="color: #ce9178;">")"</span>],
         <span style="color: #ce9178;">"((quasiquote (+ (unquote x) (unquote y))))"</span>);
        (<span style="color: #ce9178;">"`,foo"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"`"</span>, <span style="color: #ce9178;">","</span>, <span style="color: #ce9178;">"foo"</span>],
         <span style="color: #ce9178;">"((quasiquote (unquote foo)))"</span>);
        (<span style="color: #ce9178;">"`(,y ,@x)"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"`"</span>, <span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">","</span>, <span style="color: #ce9178;">"y"</span>, <span style="color: #ce9178;">",@"</span>, <span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">")"</span>],
         <span style="color: #ce9178;">"((quasiquote ((unquote y) (unquote-splice x))))"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org7ac8d3e" class="outline-4">
<h4 id="org7ac8d3e"><span class="section-number-4">8.4.4.</span> Sintaxe de vetores</h4>
<div class="outline-text-4" id="text-8-4-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">reader_vector_syntax</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_parser_test!</span>(
        state;
        (<span style="color: #ce9178;">"[]"</span>, <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"["</span>, <span style="color: #ce9178;">"]"</span>], <span style="color: #ce9178;">"((vector))"</span>);
        (<span style="color: #ce9178;">"[1 2 'a 3 (+ 2 5)]"</span>,
         <span style="color: #c586c0;">vec!</span>[<span style="color: #ce9178;">"["</span>, <span style="color: #ce9178;">"1"</span>, <span style="color: #ce9178;">"2"</span>, <span style="color: #ce9178;">"'"</span>, <span style="color: #ce9178;">"a"</span>, <span style="color: #ce9178;">"3"</span>,
              <span style="color: #ce9178;">"("</span>, <span style="color: #ce9178;">"+"</span>, <span style="color: #ce9178;">"2"</span>, <span style="color: #ce9178;">"5"</span>, <span style="color: #ce9178;">")"</span>, <span style="color: #ce9178;">"]"</span>],
         <span style="color: #ce9178;">"((vector 1 2 (quote a) 3 (+ 2 5)))"</span>);
    );
    <span style="color: #c586c0;">multi_parser_fail_test!</span>(
        state;
        <span style="color: #ce9178;">"[']"</span>;
        <span style="color: #ce9178;">"[1 2 3"</span>;
    );
}
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc44bf65" class="outline-2">
<h2 id="orgc44bf65"><span class="section-number-2">9.</span> Interpretação</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-orgbcf2e8c" class="outline-3">
<h3 id="orgbcf2e8c"><span class="section-number-3">9.1.</span> Formas especiais</h3>
<div class="outline-text-3" id="text-9-1">
</div>
<div id="outline-container-orgea2ea66" class="outline-4">
<h4 id="orgea2ea66"><span class="section-number-4">9.1.1.</span> <code>quote</code></h4>
<div class="outline-text-4" id="text-9-1-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_quote</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(quote x)"</span>, <span style="color: #ce9178;">"x"</span>);
        (<span style="color: #ce9178;">"(quote (1 2 3))"</span>, <span style="color: #ce9178;">"(1 2 3)"</span>);
        (<span style="color: #ce9178;">"(quote (+ 5 6))"</span>, <span style="color: #ce9178;">"(+ 5 6)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org9a35422" class="outline-4">
<h4 id="org9a35422"><span class="section-number-4">9.1.2.</span> <code>def</code></h4>
<div class="outline-text-4" id="text-9-1-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_def</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(def x 5)"</span>, <span style="color: #ce9178;">"x"</span>);
    );
    <span style="color: #c586c0;">multi_eval_fail_test!</span>(
        state;
        <span style="color: #ce9178;">"(def (foo bar) 5)"</span>;
        <span style="color: #ce9178;">"(def y (length x))"</span>;
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orga4d9c88" class="outline-4">
<h4 id="orga4d9c88"><span class="section-number-4">9.1.3.</span> <code>set</code></h4>
<div class="outline-text-4" id="text-9-1-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_set</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_fail_test!</span>(
        state;
        <span style="color: #ce9178;">"(set x 5)"</span>;
    );
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(def x 1)"</span>, <span style="color: #ce9178;">"x"</span>);
        (<span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">"1"</span>);
        (<span style="color: #ce9178;">"(set x 5)"</span>, <span style="color: #ce9178;">"x"</span>);
        (<span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">"5"</span>);
        (<span style="color: #ce9178;">"(let ((x 6)) x)"</span>, <span style="color: #ce9178;">"6"</span>);
        (<span style="color: #ce9178;">"(let ((x 6))</span>
<span style="color: #ce9178;">            (set x 9)</span>
<span style="color: #ce9178;">            x)"</span>,
         <span style="color: #ce9178;">"9"</span>);
        (<span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">"5"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org1857ba6" class="outline-4">
<h4 id="org1857ba6"><span class="section-number-4">9.1.4.</span> <code>set-car</code></h4>
<div class="outline-text-4" id="text-9-1-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_set_car</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(def x (quote (1 . 2)))"</span>, <span style="color: #ce9178;">"x"</span>);
        (<span style="color: #ce9178;">"(set-car x 3)"</span>, <span style="color: #ce9178;">"(3 . 2)"</span>);
        (<span style="color: #ce9178;">"(set-car (quote (9 . 0)) (quote f))"</span>,
         <span style="color: #ce9178;">"(f . 0)"</span>);
        (<span style="color: #ce9178;">"(let ((x (quote (4 . 5))))</span>
<span style="color: #ce9178;">            (set-car x 9))"</span>,
         <span style="color: #ce9178;">"(9 . 5)"</span>);
        (<span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">"(3 . 2)"</span>);
        (<span style="color: #ce9178;">"(let ((a x))</span>
<span style="color: #ce9178;">            (set-car a 4))"</span>,
         <span style="color: #ce9178;">"(4 . 2)"</span>);
        (<span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">"(4 . 2)"</span>);
        (<span style="color: #ce9178;">"(let ((a (copy x)))</span>
<span style="color: #ce9178;">            (set-car a 5))"</span>,
         <span style="color: #ce9178;">"(5 . 2)"</span>);
        (<span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">"(4 . 2)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orge57ca30" class="outline-4">
<h4 id="orge57ca30"><span class="section-number-4">9.1.5.</span> <code>set-cdr</code></h4>
<div class="outline-text-4" id="text-9-1-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_set_cdr</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(def x (quote (1 . 2)))"</span>, <span style="color: #ce9178;">"x"</span>);
        (<span style="color: #ce9178;">"(set-cdr x 3)"</span>, <span style="color: #ce9178;">"(1 . 3)"</span>);
        (<span style="color: #ce9178;">"(set-cdr (quote (9 . 0)) (quote f))"</span>,
         <span style="color: #ce9178;">"(9 . f)"</span>);
        (<span style="color: #ce9178;">"(let ((x (quote (4 . 5))))</span>
<span style="color: #ce9178;">            (set-cdr x 9))"</span>,
         <span style="color: #ce9178;">"(4 . 9)"</span>);
        (<span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">"(1 . 3)"</span>);
        (<span style="color: #ce9178;">"(let ((a x))</span>
<span style="color: #ce9178;">            (set-cdr a 4))"</span>,
         <span style="color: #ce9178;">"(1 . 4)"</span>);
        (<span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">"(1 . 4)"</span>);
        (<span style="color: #ce9178;">"(let ((a (copy x)))</span>
<span style="color: #ce9178;">            (set-cdr a 5))"</span>,
         <span style="color: #ce9178;">"(1 . 5)"</span>);
        (<span style="color: #ce9178;">"x"</span>, <span style="color: #ce9178;">"(1 . 4)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org246ccf9" class="outline-4">
<h4 id="org246ccf9"><span class="section-number-4">9.1.6.</span> <code>if</code></h4>
<div class="outline-text-4" id="text-9-1-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_if</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(if (nilp (quote a))</span>
<span style="color: #ce9178;">              (quote is-nil)</span>
<span style="color: #ce9178;">              (quote is-not-nil))"</span>,
         <span style="color: #ce9178;">"is-not-nil"</span>);
        (<span style="color: #ce9178;">"(if (nilp nil)</span>
<span style="color: #ce9178;">              (quote is-nil)</span>
<span style="color: #ce9178;">              (quote is-not-nil))"</span>,
         <span style="color: #ce9178;">"is-nil"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8037630" class="outline-4">
<h4 id="org8037630"><span class="section-number-4">9.1.7.</span> <code>fn</code></h4>
<div class="outline-text-4" id="text-9-1-7">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_fn</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(fn (x) (* x x))"</span>,
         <span style="color: #ce9178;">"(lit closure nil (x) ((* x x)))"</span>);
        (<span style="color: #ce9178;">"(fn (x . rest) (list x rest))"</span>,
         <span style="color: #ce9178;">"(lit closure nil (x . rest) ((list x rest)))"</span>);
        (<span style="color: #ce9178;">"((fn (x) (* x x)) 5)"</span>,
         <span style="color: #ce9178;">"25"</span>);
        (<span style="color: #ce9178;">"(def square (fn (x) (* x x)))"</span>,
         <span style="color: #ce9178;">"square"</span>);
        (<span style="color: #ce9178;">"(square 5)"</span>, <span style="color: #ce9178;">"25"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org61f9496" class="outline-4">
<h4 id="org61f9496"><span class="section-number-4">9.1.8.</span> <code>mac</code></h4>
<div class="outline-text-4" id="text-9-1-8">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_mac</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(mac (x) (quasiquote (list (unquote x))))"</span>,
         <span style="color: #ce9178;">"(lit macro (lit closure nil (x) ((quasiquote (list (unquote x))))))"</span>);
        (<span style="color: #ce9178;">"((mac (x) (quasiquote (list (unquote x)))) 5)"</span>,
         <span style="color: #ce9178;">"(5)"</span>);
        (<span style="color: #ce9178;">"(def encapsulate</span>
<span style="color: #ce9178;">            (mac (x) (quasiquote (list (unquote x)))))"</span>,
         <span style="color: #ce9178;">"encapsulate"</span>);
        (<span style="color: #ce9178;">"(macroexpand-1 (quote (encapsulate 5)))"</span>,
         <span style="color: #ce9178;">"(list 5)"</span>);
        (<span style="color: #ce9178;">"(encapsulate 5)"</span>, <span style="color: #ce9178;">"(5)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8d20048" class="outline-4">
<h4 id="org8d20048"><span class="section-number-4">9.1.9.</span> <code>quasiquote</code> / <code>unquote</code> / <code>unquote-splice</code></h4>
<div class="outline-text-4" id="text-9-1-9">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_quasiquote_unquote_unquote_splice</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(quasiquote a)"</span>, <span style="color: #ce9178;">"a"</span>);
        (<span style="color: #ce9178;">"(let ((x 5)  (y 6))</span>
<span style="color: #ce9178;">            (quasiquote (1 (unquote x) (unquote y))))"</span>,
         <span style="color: #ce9178;">"(1 5 6)"</span>);
        (<span style="color: #ce9178;">"(let ((lst (list 1 2 3)))</span>
<span style="color: #ce9178;">            (quasiquote (0 (unquote lst))))"</span>,
         <span style="color: #ce9178;">"(0 (1 2 3))"</span>);
        (<span style="color: #ce9178;">"(let ((lst (list 1 2 3)))</span>
<span style="color: #ce9178;">            (quasiquote (0 (unquote-splice lst))))"</span>,
         <span style="color: #ce9178;">"(0 1 2 3)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb2df67e" class="outline-4">
<h4 id="orgb2df67e"><span class="section-number-4">9.1.10.</span> <code>do</code></h4>
<div class="outline-text-4" id="text-9-1-10">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_do</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(do (quote a)</span>
<span style="color: #ce9178;">              (quote b)</span>
<span style="color: #ce9178;">              (list (quote c)</span>
<span style="color: #ce9178;">                    (quote d)</span>
<span style="color: #ce9178;">                    (quote e)))"</span>,
         <span style="color: #ce9178;">"(c d e)"</span>);
        (<span style="color: #ce9178;">"(do)"</span>, <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgce2add8" class="outline-4">
<h4 id="orgce2add8"><span class="section-number-4">9.1.11.</span> <span class="todo TODO">TODO</span> <code>apply</code></h4>
<div class="outline-text-4" id="text-9-1-11">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_apply</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org782741f" class="outline-4">
<h4 id="org782741f"><span class="section-number-4">9.1.12.</span> <code>while</code></h4>
<div class="outline-text-4" id="text-9-1-12">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_while</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(let ((x 0)  (lst nil))</span>
<span style="color: #ce9178;">            (while (&lt; x 5)</span>
<span style="color: #ce9178;">              (set lst (cons x lst))</span>
<span style="color: #ce9178;">              (set x (1+ x)))</span>
<span style="color: #ce9178;">            (list x lst))"</span>,
         <span style="color: #ce9178;">"(5 (4 3 2 1 0))"</span>);
        (<span style="color: #ce9178;">"(let ((lst (quote (1 2 3 4 5)))</span>
<span style="color: #ce9178;">                (result nil))</span>
<span style="color: #ce9178;">            (while (not (nilp lst))</span>
<span style="color: #ce9178;">              (let (((num . rest) lst))</span>
<span style="color: #ce9178;">                (set result</span>
<span style="color: #ce9178;">                     (cons (= 2 num) result))</span>
<span style="color: #ce9178;">                (set lst rest)))</span>
<span style="color: #ce9178;">            result)"</span>,
         <span style="color: #ce9178;">"(nil nil nil t nil)"</span>);
    );
    <span style="color: #c586c0;">multi_eval_fail_test!</span>(
        state;
        <span style="color: #ce9178;">"(let ((lst (quote (1 2 3 a 5))))</span>
<span style="color: #ce9178;">           (while (not (nilp lst))</span>
<span style="color: #ce9178;">             (let (((num . rest) lst))</span>
<span style="color: #ce9178;">               (= 2 num))</span>
<span style="color: #ce9178;">             (set lst rest)))"</span>;
        <span style="color: #ce9178;">"(let ((lst (quote (1 2 3 NaN 5))))</span>
<span style="color: #ce9178;">           (while (not (nilp lst))</span>
<span style="color: #ce9178;">             (let (((num . rest) lst))</span>
<span style="color: #ce9178;">               (= 2 num))</span>
<span style="color: #ce9178;">             (set lst rest)))"</span>;
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd3caa8" class="outline-4">
<h4 id="orgbd3caa8"><span class="section-number-4">9.1.13.</span> <code>and</code></h4>
<div class="outline-text-4" id="text-9-1-13">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_and</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(and (= 1 1) (= 0.5 1/2) (quote ok))"</span>,
         <span style="color: #ce9178;">"ok"</span>);
        (<span style="color: #ce9178;">"(and (= 1 1) (&lt; 0.5 1/2) (quote ok))"</span>,
         <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(and)"</span>, <span style="color: #ce9178;">"t"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf96d703" class="outline-4">
<h4 id="orgf96d703"><span class="section-number-4">9.1.14.</span> <code>or</code></h4>
<div class="outline-text-4" id="text-9-1-14">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_or</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(or (not (= 1 1))</span>
<span style="color: #ce9178;">              (&lt; 0.5 1/2)</span>
<span style="color: #ce9178;">              (quote ok))"</span>,
         <span style="color: #ce9178;">"ok"</span>);
        (<span style="color: #ce9178;">"(or (= 1 1) (&lt; 0.5 1/2))"</span>,
         <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(or)"</span>, <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org298a089" class="outline-4">
<h4 id="org298a089"><span class="section-number-4">9.1.15.</span> <code>letrec</code></h4>
<div class="outline-text-4" id="text-9-1-15">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_letrec</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(let ((results nil))</span>
<span style="color: #ce9178;">            (letrec ((foo ()</span>
<span style="color: #ce9178;">                       (set results</span>
<span style="color: #ce9178;">                         (cons (quote foo) results))</span>
<span style="color: #ce9178;">                       (bar))</span>
<span style="color: #ce9178;">                     (bar ()</span>
<span style="color: #ce9178;">                       (set results</span>
<span style="color: #ce9178;">                         (cons (quote bar) results))</span>
<span style="color: #ce9178;">                       (baz))</span>
<span style="color: #ce9178;">                     (baz ()</span>
<span style="color: #ce9178;">                       (set results</span>
<span style="color: #ce9178;">                         (cons (quote baz) results))</span>
<span style="color: #ce9178;">                       results))</span>
<span style="color: #ce9178;">              (foo)))"</span>,
         <span style="color: #ce9178;">"(baz bar foo)"</span>);
        (<span style="color: #ce9178;">"(letrec ((iter (x)</span>
<span style="color: #ce9178;">                     (if (&gt; x 0)</span>
<span style="color: #ce9178;">                       (iter (1- x))</span>
<span style="color: #ce9178;">                       (quote finished))))</span>
<span style="color: #ce9178;">            (iter 5))"</span>,
         <span style="color: #ce9178;">"finished"</span>);
        (<span style="color: #ce9178;">"(def my-function</span>
<span style="color: #ce9178;">               (letrec ((foo () (bar))</span>
<span style="color: #ce9178;">                        (bar () (quote hello-from-bar)))</span>
<span style="color: #ce9178;">                 foo))"</span>,
         <span style="color: #ce9178;">"my-function"</span>);
        (<span style="color: #ce9178;">"(my-function)"</span>, <span style="color: #ce9178;">"hello-from-bar"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaf59507" class="outline-4">
<h4 id="orgaf59507"><span class="section-number-4">9.1.16.</span> <code>unwind-protect</code></h4>
<div class="outline-text-4" id="text-9-1-16">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_unwind_protect</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(def *my-stream* nil)"</span>, <span style="color: #ce9178;">"*my-stream*"</span>);
        (<span style="color: #ce9178;">"(unwind-protect</span>
<span style="color: #ce9178;">              (do (set *my-stream*</span>
<span style="color: #ce9178;">                       (open-stream 'in</span>
<span style="color: #ce9178;">                                    \"test-streams-in.txt\"))</span>
<span style="color: #ce9178;">                  (read-char *my-stream*))</span>
<span style="color: #ce9178;">            (do (close-stream *my-stream*)</span>
<span style="color: #ce9178;">                (set *my-stream* nil)))"</span>,
         <span style="color: #ce9178;">"#\\H"</span>);
        (<span style="color: #ce9178;">"*my-stream*"</span>, <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(and (set *my-stream*</span>
<span style="color: #ce9178;">                  (open-stream 'out \"test-streams-out.txt\"))</span>
<span style="color: #ce9178;">               t)"</span>,
         <span style="color: #ce9178;">"t"</span>);
    );
    <span style="color: #c586c0;">multi_eval_fail_test!</span>(
        state;
        <span style="color: #ce9178;">"(unwind-protect (read-char *my-stream*)</span>
<span style="color: #ce9178;">           (do (close-stream *my-stream*)</span>
<span style="color: #ce9178;">               (set *my-stream* nil)))"</span>;
             
    );
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"*my-stream*"</span>, <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc8cd561" class="outline-3">
<h3 id="orgc8cd561"><span class="section-number-3">9.2.</span> Aplicação de clausuras</h3>
<div class="outline-text-3" id="text-9-2">
</div>
<div id="outline-container-orgb72b87d" class="outline-4">
<h4 id="orgb72b87d"><span class="section-number-4">9.2.1.</span> <span class="todo TODO">TODO</span> Aplicação comum</h4>
<div class="outline-text-4" id="text-9-2-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_closure_application_default</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org04ccaa8" class="outline-4">
<h4 id="org04ccaa8"><span class="section-number-4">9.2.2.</span> <span class="todo TODO">TODO</span> Aplicação parcial</h4>
<div class="outline-text-4" id="text-9-2-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_closure_application_partial</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb4ebb83" class="outline-4">
<h4 id="orgb4ebb83"><span class="section-number-4">9.2.3.</span> <span class="todo TODO">TODO</span> Argumentos opcionais</h4>
<div class="outline-text-4" id="text-9-2-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_closure_application_optional_args</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf4c84c1" class="outline-4">
<h4 id="orgf4c84c1"><span class="section-number-4">9.2.4.</span> <span class="todo TODO">TODO</span> Aplicação parcial forçada</h4>
<div class="outline-text-4" id="text-9-2-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_closure_application_forced</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga6676e7" class="outline-3">
<h3 id="orga6676e7"><span class="section-number-3">9.3.</span> Bootstrap</h3>
<div class="outline-text-3" id="text-9-3">
</div>
<div id="outline-container-org3399466" class="outline-4">
<h4 id="org3399466"><span class="section-number-4">9.3.1.</span> Constantes</h4>
<div class="outline-text-4" id="text-9-3-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_bootstrap_constants</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(type *stdin*)"</span>, <span style="color: #ce9178;">"stream"</span>);
        (<span style="color: #ce9178;">"(type *stdout*)"</span>, <span style="color: #ce9178;">"stream"</span>);
        (<span style="color: #ce9178;">"*ulps*"</span>, <span style="color: #ce9178;">"3"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org4fdb8c3" class="outline-4">
<h4 id="org4fdb8c3"><span class="section-number-4">9.3.2.</span> <code>map</code> e <code>mapc</code></h4>
<div class="outline-text-4" id="text-9-3-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_bootstrap_map_mapc</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(map (fn (x) (* x x))</span>
<span style="color: #ce9178;">               (quote (1 2 3 4 5)))"</span>,
         <span style="color: #ce9178;">"(1 4 9 16 25)"</span>);
        (<span style="color: #ce9178;">"(map (fn (x) (* x x))</span>
<span style="color: #ce9178;">               (quote (1 2 3 4 . 5)))"</span>,
         <span style="color: #ce9178;">"(1 4 9 16)"</span>);
        (<span style="color: #ce9178;">"(mapc (fn (x) (* x x))</span>
<span style="color: #ce9178;">                (quote (1 2 3 4 5)))"</span>,
         <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(let ((results nil))</span>
<span style="color: #ce9178;">            (mapc (fn (x)</span>
<span style="color: #ce9178;">                    (set results</span>
<span style="color: #ce9178;">                         (cons (* x x) results)))</span>
<span style="color: #ce9178;">                  (quote (1 2 3 4 5)))</span>
<span style="color: #ce9178;">            results)"</span>,
         <span style="color: #ce9178;">"(25 16 9 4 1)"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org9d0955b" class="outline-4">
<h4 id="org9d0955b"><span class="section-number-4">9.3.3.</span> <code>vector=</code></h4>
<div class="outline-text-4" id="text-9-3-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_bootstrap_vectorequal</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(vector= [1 2 3] [1 2 3])"</span>,     <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(let ((v [5 6 7 8]))</span>
<span style="color: #ce9178;">            (vector= v [5 6 7 8]))"</span>,      <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(vector= [1 2] [3 4 5])"</span>,       <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(vector= \"Hello\" \"Hello\")"</span>, <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(vector= ['a 'b] [#\\a #\\b])"</span>, <span style="color: #ce9178;">"nil"</span>);
    );
    <span style="color: #c586c0;">multi_eval_fail_test!</span>(
        state;
        <span style="color: #ce9178;">"(vector= 'a ['a])"</span>;
        <span style="color: #ce9178;">"(vector= [5] 5)"</span>;
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org77e925e" class="outline-4">
<h4 id="org77e925e"><span class="section-number-4">9.3.4.</span> <code>equal</code></h4>
<div class="outline-text-4" id="text-9-3-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_bootstrap_equal</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(equal 0.5 1/2)"</span>,             <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(equal [1 2 3] [1 2 3])"</span>,     <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(equal 'a 'b)"</span>,               <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(equal '(a b c) '(a b c))"</span>,   <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(equal #\\F #\\F)"</span>,           <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(equal *stdin* *stdin*)"</span>,     <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(equal *stdin* *stdout*)"</span>,    <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(equal 20 'a)"</span>,               <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(equal *stdout* '(a b c))"</span>,   <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(equal [6 5] '(6 5))"</span>,        <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(equal \"Teste\" \"Teste\")"</span>, <span style="color: #ce9178;">"t"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org715cbea" class="outline-4">
<h4 id="org715cbea"><span class="section-number-4">9.3.5.</span> <code>assp</code> e <code>assoc</code></h4>
<div class="outline-text-4" id="text-9-3-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_bootstrap_assp_assoc</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(assp (fn (x) (eq (quote b) x))</span>
<span style="color: #ce9178;">                (quote ((a . 1) (b . 2) (c . 3))))"</span>,
         <span style="color: #ce9178;">"(b . 2)"</span>);
        (<span style="color: #ce9178;">"(assp (eq (quote b))</span>
<span style="color: #ce9178;">                (quote ((a . 1) (b . 2) (c . 3))))"</span>,
         <span style="color: #ce9178;">"(b . 2)"</span>);
        (<span style="color: #ce9178;">"(assp (eq (quote z))</span>
<span style="color: #ce9178;">                (quote ((a . 1) (b . 2) (c . 3))))"</span>,
         <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(assoc (quote b)</span>
<span style="color: #ce9178;">                 (quote ((a . 1) (b . 2) (c . 3))))"</span>,
         <span style="color: #ce9178;">"(b . 2)"</span>);
        (<span style="color: #ce9178;">"(assoc (quote a)</span>
<span style="color: #ce9178;">                 (quote ((a . 1) (b . 2) (c . 3))))"</span>,
         <span style="color: #ce9178;">"(a . 1)"</span>);
        (<span style="color: #ce9178;">"(letfn ((equal (x y)</span>
<span style="color: #ce9178;">                    (= x y)))</span>
<span style="color: #ce9178;">            (assoc 2 (quote ((1 . a) (2 . b) (3 . c)))))"</span>,
         <span style="color: #ce9178;">"(2 . b)"</span>);
        (<span style="color: #ce9178;">"(assoc (quote z)</span>
<span style="color: #ce9178;">                 (quote ((a . 1) (b . 2) (c . 3))))"</span>,
         <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org498ef0e" class="outline-4">
<h4 id="org498ef0e"><span class="section-number-4">9.3.6.</span> <code>member</code></h4>
<div class="outline-text-4" id="text-9-3-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_bootstrap_member</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_eval_test!</span>(
        state;
        (<span style="color: #ce9178;">"(member (quote a) (quote (x y z a b c)))"</span>,
         <span style="color: #ce9178;">"(a b c)"</span>);
        (<span style="color: #ce9178;">"(member (quote x) (quote (x y z a b c)))"</span>,
         <span style="color: #ce9178;">"(x y z a b c)"</span>);
        (<span style="color: #ce9178;">"(member (quote c) (quote (x y z a b c)))"</span>,
         <span style="color: #ce9178;">"(c)"</span>);
        (<span style="color: #ce9178;">"(letfn ((equal (x y)</span>
<span style="color: #ce9178;">                    (= x y)))</span>
<span style="color: #ce9178;">            (member 1 (quote (5 6 7 1 2 3))))"</span>,
         <span style="color: #ce9178;">"(1 2 3)"</span>);
        (<span style="color: #ce9178;">"(member (quote n) (quote (x y z a b c)))"</span>,
         <span style="color: #ce9178;">"nil"</span>);
    );
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc1334c6" class="outline-3">
<h3 id="orgc1334c6"><span class="section-number-3">9.4.</span> <span class="todo TODO">TODO</span> Aplicação de primitivas</h3>
<div class="outline-text-3" id="text-9-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">evaluator_primitives_application</span>() {
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org5800ef1" class="outline-3">
<h3 id="org5800ef1"><span class="section-number-3">9.5.</span> <span class="todo TODO">TODO</span> Expansão de macros</h3>
<div class="outline-text-3" id="text-9-5">
</div>
<div id="outline-container-org390e9bc" class="outline-4">
<h4 id="org390e9bc"><span class="section-number-4">9.5.1.</span> <code>cond</code></h4>
<div class="outline-text-4" id="text-9-5-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">macros_cond</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_macroexpand_1_test!</span> {
        state;
        (<span style="color: #ce9178;">"(cond (a b)</span>
<span style="color: #ce9178;">                (t c))"</span>,
         <span style="color: #ce9178;">"(if a (do b) (cond (t c)))"</span>);
        (<span style="color: #ce9178;">"(cond ((numberp x) x))"</span>,
         <span style="color: #ce9178;">"(if (numberp x) (do x) nil)"</span>);
    };
    <span style="color: #c586c0;">multi_eval_test!</span> {
        state;
        (<span style="color: #ce9178;">"(let ((x 1))</span>
<span style="color: #ce9178;">            (cond ((zerop x) 0)</span>
<span style="color: #ce9178;">                  ((&lt; x 1) (- x))</span>
<span style="color: #ce9178;">                  (t x)))"</span>,
         <span style="color: #ce9178;">"1"</span>);
        (<span style="color: #ce9178;">"(let ((x 0))</span>
<span style="color: #ce9178;">            (cond ((zerop x) 0)</span>
<span style="color: #ce9178;">                  ((&lt; x 1) (- x))</span>
<span style="color: #ce9178;">                  (t x)))"</span>,
         <span style="color: #ce9178;">"0"</span>);
        (<span style="color: #ce9178;">"(cond (t (quote a)))"</span>, <span style="color: #ce9178;">"a"</span>);
        (<span style="color: #ce9178;">"(cond ((eq (quote a)</span>
<span style="color: #ce9178;">                     (quote b))</span>
<span style="color: #ce9178;">                 (quote ok)))"</span>,
         <span style="color: #ce9178;">"nil"</span>);
    };
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org57a2649" class="outline-4">
<h4 id="org57a2649"><span class="section-number-4">9.5.2.</span> <code>defn</code></h4>
<div class="outline-text-4" id="text-9-5-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">macros_defn</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_macroexpand_1_test!</span> {
        state;
        (<span style="color: #ce9178;">"(defn name lambda-list body1 body2)"</span>,
         <span style="color: #ce9178;">"(def name (fn lambda-list body1 body2))"</span>);
        (<span style="color: #ce9178;">"(defn identity (x) x)"</span>,
         <span style="color: #ce9178;">"(def identity (fn (x) x))"</span>);
    }
    <span style="color: #c586c0;">multi_eval_test!</span> {
        state;
        (<span style="color: #ce9178;">"(defn identity (x) x)"</span>, <span style="color: #ce9178;">"identity"</span>);
        (<span style="color: #ce9178;">"(closurep identity)"</span>,   <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"identity"</span>, <span style="color: #ce9178;">"(lit closure nil (x) (x))"</span>);
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8035a01" class="outline-4">
<h4 id="org8035a01"><span class="section-number-4">9.5.3.</span> <code>defmac</code></h4>
<div class="outline-text-4" id="text-9-5-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">macros_defmac</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_macroexpand_1_test!</span> {
        state;
        (<span style="color: #ce9178;">"(defmac name lambda-list body1 body2)"</span>,
         <span style="color: #ce9178;">"(def name (mac lambda-list body1 body2))"</span>);
        (<span style="color: #ce9178;">"(defmac call (f) (quasiquote ((unquote f))))"</span>,
         <span style="color: #ce9178;">"(def call (mac (f) (quasiquote ((unquote f)))))"</span>);
    }
    <span style="color: #c586c0;">multi_eval_test!</span> {
        state;
        (<span style="color: #ce9178;">"(defmac call (f) (quasiquote ((unquote f))))"</span>,
         <span style="color: #ce9178;">"call"</span>);
        (<span style="color: #ce9178;">"(macrop call)"</span>,   <span style="color: #ce9178;">"t"</span>);
        (<span style="color: #ce9178;">"(defn foo () 1)"</span>, <span style="color: #ce9178;">"foo"</span>);
        (<span style="color: #ce9178;">"(call foo)"</span>, <span style="color: #ce9178;">"1"</span>);
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeb64a03" class="outline-4">
<h4 id="orgeb64a03"><span class="section-number-4">9.5.4.</span> <code>let</code> e <code>let*</code></h4>
<div class="outline-text-4" id="text-9-5-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">macros_let_letstar</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_macroexpand_1_test!</span> {
        state;
        (<span style="color: #ce9178;">"(let ((x 1)  (y 2))</span>
<span style="color: #ce9178;">            (+ x y))"</span>,
         <span style="color: #ce9178;">"((fn (y x) (+ x y)) 2 1)"</span>);
        (<span style="color: #ce9178;">"(let* ((x 1)  (y (1+ x)))</span>
<span style="color: #ce9178;">            (+ x y))"</span>,
         <span style="color: #ce9178;">"(let ((x 1)) (let* ((y (1+ x))) (+ x y)))"</span>);
        (<span style="color: #ce9178;">"(let* ((x (* 2 3))</span>
<span style="color: #ce9178;">                 (y (1+ x))</span>
<span style="color: #ce9178;">                 (z (+ y 3)))</span>
<span style="color: #ce9178;">            (+ x y z))"</span>,
         <span style="color: #ce9178;">"(let ((x (* 2 3))) (let* ((y (1+ x)) (z (+ y 3))) (+ x y z)))"</span>);
    }
    <span style="color: #c586c0;">multi_eval_test!</span> {
        state;
        (<span style="color: #ce9178;">"(let ((x 1)  (y 2))</span>
<span style="color: #ce9178;">            (+ x y))"</span>,
         <span style="color: #ce9178;">"3"</span>);
        (<span style="color: #ce9178;">"(let* ((x (* 2 3))</span>
<span style="color: #ce9178;">                 (y (1+ x))</span>
<span style="color: #ce9178;">                 (z (+ y 3)))</span>
<span style="color: #ce9178;">            (+ x y z))"</span>,
         <span style="color: #ce9178;">"23"</span>);
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgad66abc" class="outline-4">
<h4 id="orgad66abc"><span class="section-number-4">9.5.5.</span> <code>letfn</code> e <code>letfn*</code></h4>
<div class="outline-text-4" id="text-9-5-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">macros_letfn_letfnstar</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_macroexpand_1_test!</span> {
        state;
        (<span style="color: #ce9178;">"(letfn ((foo (x) (+ 1 2 x))</span>
<span style="color: #ce9178;">                  (bar (x) x))</span>
<span style="color: #ce9178;">            (foo 5))"</span>,
         <span style="color: #ce9178;">"((fn (bar foo) (foo 5)) (fn (x) x) (fn (x) (+ 1 2 x)))"</span>);
        (<span style="color: #ce9178;">"(letfn* ((foo (x) (+ 1 2 x))</span>
<span style="color: #ce9178;">                   (bar (x) (foo x)))</span>
<span style="color: #ce9178;">            (bar 5))"</span>,
         <span style="color: #ce9178;">"(letfn ((foo (x) (+ 1 2 x))) (letfn* ((bar (x) (foo x))) (bar 5)))"</span>);
    }
    <span style="color: #c586c0;">multi_eval_test!</span> {
        state;
        (<span style="color: #ce9178;">"(letfn ((foo (x) (+ 1 2 x)))</span>
<span style="color: #ce9178;">            (foo 5))"</span>,
         <span style="color: #ce9178;">"8"</span>);
        (<span style="color: #ce9178;">"(letfn* ((foo (x) (+ 1 2 x))</span>
<span style="color: #ce9178;">                   (bar (x) (foo x)))</span>
<span style="color: #ce9178;">            (bar 5))"</span>,
         <span style="color: #ce9178;">"8"</span>);
    };
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d9362e" class="outline-4">
<h4 id="org3d9362e"><span class="section-number-4">9.5.6.</span> <code>when</code> e <code>unless</code></h4>
<div class="outline-text-4" id="text-9-5-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">macros_when_unless</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_macroexpand_1_test!</span> {
        state;
        (<span style="color: #ce9178;">"(when t</span>
<span style="color: #ce9178;">            (print \"Hello\")</span>
<span style="color: #ce9178;">            (+ 2 3))"</span>,
         <span style="color: #ce9178;">"(if t (do (print \"Hello\") (+ 2 3)) nil)"</span>);
        (<span style="color: #ce9178;">"(unless t</span>
<span style="color: #ce9178;">            (print \"Hello\")</span>
<span style="color: #ce9178;">            (+ 2 3))"</span>,
         <span style="color: #ce9178;">"(if (not t) (do (print \"Hello\") (+ 2 3)) nil)"</span>);
    }
    <span style="color: #c586c0;">multi_eval_test!</span> {
        state;
        (<span style="color: #ce9178;">"(when t (+ 2 3))"</span>,         <span style="color: #ce9178;">"5"</span>);
        (<span style="color: #ce9178;">"(when (= 2 3) (+ 2 3))"</span>,   <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(unless t (+ 2 3))"</span>,       <span style="color: #ce9178;">"nil"</span>);
        (<span style="color: #ce9178;">"(unless (= 2 3) (+ 2 3))"</span>, <span style="color: #ce9178;">"5"</span>);
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org2cae259" class="outline-4">
<h4 id="org2cae259"><span class="section-number-4">9.5.7.</span> <code>until</code></h4>
<div class="outline-text-4" id="text-9-5-7">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">macros_until</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_macroexpand_1_test!</span> {
        state;
        (<span style="color: #ce9178;">"(until (&gt;= x 5)</span>
<span style="color: #ce9178;">            (set x (1+ x)))"</span>,
         <span style="color: #ce9178;">"(while (not (&gt;= x 5)) (set x (1+ x)))"</span>);
    }
    <span style="color: #c586c0;">multi_eval_test!</span> {
        state;
        (<span style="color: #ce9178;">"(let ((x 0))</span>
<span style="color: #ce9178;">            (until (&gt;= x 5)</span>
<span style="color: #ce9178;">              (set x (1+ x)))</span>
<span style="color: #ce9178;">            x)"</span>,
         <span style="color: #ce9178;">"5"</span>);
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org383652d" class="outline-4">
<h4 id="org383652d"><span class="section-number-4">9.5.8.</span> <span class="todo TODO">TODO</span> <code>repeat</code></h4>
<div class="outline-text-4" id="text-9-5-8">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #c586c0;">#[ignore]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">macros_repeat</span>() {
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">Needs a macroexpand-1 macro which accepts</span>
    <span style="color: #6a9955;">// </span><span style="color: #6a9955;">generated-symbol regex</span>
    <span style="color: #c586c0;">unimplemented!</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org2e927cb" class="outline-4">
<h4 id="org2e927cb"><span class="section-number-4">9.5.9.</span> <code>with-open-stream</code></h4>
<div class="outline-text-4" id="text-9-5-9">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #c586c0;">#[test]</span>
<span style="color: #569cd6;">fn</span> <span style="color: #dcdcaa;">macros_with_open_stream</span>() {
    <span style="color: #569cd6;">let</span> <span style="color: #569cd6;">mut</span> <span style="color: #9cdcfe;">state</span> = <span style="color: #4ec9b0;">MajState</span>::new();
    <span style="color: #c586c0;">multi_macroexpand_1_test!</span> {
        state;
        (<span style="color: #ce9178;">"(with-open-stream (s (quote in) \"test-streams-in.txt\")</span>
<span style="color: #ce9178;">            (read-char s))"</span>,
         <span style="color: #ce9178;">"(let ((s (open-stream (quote in) \"test-streams-in.txt\"))) (unwind-protect (do (read-char s)) (close-stream s)))"</span>);
    }
    <span style="color: #c586c0;">multi_eval_test!</span> {
        state;
        (<span style="color: #ce9178;">"(with-open-stream (s (quote in) \"test-streams-in.txt\")</span>
<span style="color: #ce9178;">            (read-char s))"</span>,
         <span style="color: #ce9178;">"#\\H"</span>);
    }
}
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Lucas S. Vieira</p>
<p class="date">Created: 2022-10-24 seg 00:27</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
